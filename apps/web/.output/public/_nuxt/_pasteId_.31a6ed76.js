import{s as M,a as O,_ as K}from"./logo-paste-created.c03904b9.js";import{m as q,q as h,s as $,v as R,w as U,u as p,x as V,h as Q,y as G,j as J,z as T,B,C as F,k as L,o as m,b as g,c as W,e as i,D as H,t as X,l as Y,E as Z,G as ee,H as te,I as ae,p as se,f as oe,i as ne}from"./entry.ebac6982.js";const re=()=>null;function z(...l){var c,k,D,v,w,C,I,S,u;const d=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(d);let[a,_,e={}]=l;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof _!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=(c=e.server)!=null?c:!0,e.default=(k=e.default)!=null?k:re,e.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),e.lazy=(v=(D=e.lazy)!=null?D:e.defer)!=null?v:!1,e.initialCache=(w=e.initialCache)!=null?w:!0,e.immediate=(C=e.immediate)!=null?C:!0;const s=q(),y=()=>(s.isHydrating||e.initialCache)&&s.payload.data[a]!==void 0;s._asyncData[a]||(s._asyncData[a]={data:h(y()?s.payload.data[a]:(S=(I=e.default)==null?void 0:I.call(e))!=null?S:null),pending:h(!y()),error:h((u=s.payload._errors[a])!=null?u:null)});const t={...s._asyncData[a]};t.refresh=t.execute=(n={})=>s._asyncDataPromises[a]?s._asyncDataPromises[a]:n._initial&&y()?s.payload.data[a]:(t.pending.value=!0,s._asyncDataPromises[a]=new Promise((o,r)=>{try{o(_(s))}catch(f){r(f)}}).then(o=>{e.transform&&(o=e.transform(o)),e.pick&&(o=ie(o,e.pick)),t.data.value=o,t.error.value=null}).catch(o=>{var r,f;t.error.value=o,t.data.value=p((f=(r=e.default)==null?void 0:r.call(e))!=null?f:null)}).finally(()=>{t.pending.value=!1,s.payload.data[a]=t.data.value,t.error.value&&(s.payload._errors[a]=!0),delete s._asyncDataPromises[a]}),s._asyncDataPromises[a]);const x=()=>t.refresh({_initial:!0}),P=e.server!==!1&&s.payload.serverRendered;{const n=V();if(n&&!n._nuxtOnBeforeMountCbs){n._nuxtOnBeforeMountCbs=[];const r=n._nuxtOnBeforeMountCbs;n&&($(()=>{r.forEach(f=>{f()}),r.splice(0,r.length)}),R(()=>r.splice(0,r.length)))}P&&s.isHydrating&&a in s.payload.data?t.pending.value=!1:n&&(s.payload.serverRendered&&s.isHydrating||e.lazy)&&e.immediate?n._nuxtOnBeforeMountCbs.push(x):e.immediate&&x(),e.watch&&U(e.watch,()=>t.refresh());const o=s.hook("app:data:refresh",r=>{if(!r||r.includes(a))return t.refresh()});n&&R(o)}const b=Promise.resolve(s._asyncDataPromises[a]).then(()=>t);return Object.assign(b,t),b}function ie(l,d){const a={};for(const _ of d)a[_]=l[_];return a}function le(l){return{}}const E=l=>(se("data-v-e7845850"),l=l(),oe(),l),ce={key:0},de={key:1,class:"flex flex-row justify-center items-center mt-12"},ue=["data"],fe=E(()=>i("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[i("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),pe={key:2,class:"flex flex-row justify-center items-center mt-12"},he=["data"],_e={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ye=E(()=>i("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),me=H(" Check it at: "),ve=["href"],ge={key:1},xe={key:0,class:"flex flex-col items-center space-y-4"},we=E(()=>i("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),be={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},ke=["onKeyup"],De={key:1},Pe=E(()=>i("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[i("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Pe],Ie={__name:"[pasteId]",async setup(l){let d,a;const _=G(),e=J();let{data:s,error:y}=([d,a]=T(async()=>z("paste",async u=>{const o=B().params.pasteId,r=le().cookie,f={};return r.split(";").forEach(j=>{const N=j.split("=");f[N[0].trim()]=N[1]}),await $fetch(`${ne().public.webAddress}/api/paste/${o}`,{headers:{Authorization:"ApiKey "+f.quickpaste_auth},parseResponse:JSON.parse})},{server:!0})),d=await d,a(),d),t=h(s);t.value,y.value&&console.log(y.value);let{data:x}=([d,a]=T(()=>z("error",()=>y.value?y.value.response.status:200,{server:!0})),d=await d,a(),d),P=h(!1);const b=B();let c=h("");function k(){if(_.user()==null||t.value==null||t.value.owner.id!=_.id())return;B().query.edit&&(P.value=!0)}async function D(){if(c.value.length===0){e.addNotification({type:1,title:"Please enter password to view",level:1});return}const u=await fetch(`/api/paste/${b.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(u.ok)t.value=await u.json(),x=0,c.value.length!=0&&(t.value.password=c.value),k(),document.title="Quickpaste | "+t.value.title.substring(0,25);else{switch(u.status){case 401:e.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",x=u.status}}let v=h(0),w=h(void 0);const C=h(null),I=h(null),S=async u=>{v.value=1;const n={"Content-Type":"application/json"};c.value.length!=0&&(n["Paste-Authorization"]=c.value);const o=await fetch(`/api/paste/${b.params.pasteId}`,{method:"PUT",headers:n,credentials:"include",body:JSON.stringify(u)});o.ok&&(v.value=2,w.value=(await o.json()).result)};return t.value&&(document.title="Quickpaste | "+t.value.title.substring(0,25)),F(()=>{console.log(t),k()}),(u,n)=>{var f,A;const o=K,r=L("font-awesome-icon");return m(),g("div",null,[p(t)?(m(),g("div",ce,[p(v)==0?(m(),W(o,{key:0,onSubmit:S,paste:p(t),editable:p(P),submitText:"Re-Paste !"},null,8,["paste","editable"])):p(v)==1?(m(),g("div",de,[i("object",{width:"300",height:"300",type:"image/svg+xml",data:p(M)},[i("img",{ref_key:"img0",ref:C,src:M},null,512)],8,ue),fe])):(m(),g("div",pe,[i("object",{width:"300",height:"300",type:"image/svg+xml",data:p(O)},[i("img",{ref_key:"img1",ref:I,src:O},null,512)],8,he),i("div",_e,[ye,i("h3",null,[me,i("a",{class:"font-bold",href:`/${(f=p(w))==null?void 0:f.pasteId}`},[H(X((A=p(w))==null?void 0:A.pasteId)+" ",1),Y(r,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ve)])])]))])):(m(),g("div",ge,[p(x)==401?(m(),g("div",xe,[we,i("div",be,[Z(i("input",{onKeyup:te(D,["enter"]),"onUpdate:modelValue":n[0]||(n[0]=j=>ae(c)?c.value=j:c=j),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,ke),[[ee,p(c)]]),i("button",{onClick:D,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(m(),g("div",De,Ce))]))])}}},Ae=Q(Ie,[["__scopeId","data-v-e7845850"]]);export{Ae as default};
