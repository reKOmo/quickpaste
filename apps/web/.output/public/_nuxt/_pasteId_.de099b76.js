import{s as R,a as H,_ as z}from"./logo-paste-created.234c9a74.js";import{m as K,q as x,s as q,v as F,x as S,y as $,u as f,z as U,A as V,h as J,B as Q,j as G,w as j,D as A,E as L,k as W,b as g,c as X,e as r,G as B,t as Y,l as Z,H as ee,I as te,J as ae,K as se,N,o as v,p as oe,f as ne,i as re}from"./entry.f19d1878.js";const ie=()=>null;function M(...l){const d=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(d);let[e,h,t={}]=l;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof h!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=t.server??!0,t.default=t.default??ie,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0;const a=K(),m=()=>a.isHydrating?a.payload.data[e]:a.static.data[e],n=()=>m()!==void 0;a._asyncData[e]||(a._asyncData[e]={data:x(m()??t.default()),pending:x(!n()),error:q(a.payload._errors,e)});const s={...a._asyncData[e]};s.refresh=s.execute=(i={})=>{if(a._asyncDataPromises[e]){if(i.dedupe===!1)return a._asyncDataPromises[e];a._asyncDataPromises[e].cancelled=!0}if((i._initial||a.isHydrating&&i._initial!==!1)&&n())return m();s.pending.value=!0;const _=new Promise((o,u)=>{try{o(h(a))}catch(O){u(O)}}).then(o=>{if(_.cancelled)return a._asyncDataPromises[e];let u=o;t.transform&&(u=t.transform(o)),t.pick&&(u=le(u,t.pick)),s.data.value=u,s.error.value=null}).catch(o=>{if(_.cancelled)return a._asyncDataPromises[e];s.error.value=o,s.data.value=f(t.default())}).finally(()=>{_.cancelled||(s.pending.value=!1,a.payload.data[e]=s.data.value,s.error.value&&(a.payload._errors[e]=U(s.error.value)),delete a._asyncDataPromises[e])});return a._asyncDataPromises[e]=_,a._asyncDataPromises[e]};const k=()=>s.refresh({_initial:!0}),P=t.server!==!1&&a.payload.serverRendered;{const i=V();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const o=i._nuxtOnBeforeMountCbs;i&&(F(()=>{o.forEach(u=>{u()}),o.splice(0,o.length)}),S(()=>o.splice(0,o.length)))}P&&a.isHydrating&&n()?s.pending.value=!1:i&&(a.payload.serverRendered&&a.isHydrating||t.lazy)&&t.immediate?i._nuxtOnBeforeMountCbs.push(k):t.immediate&&k(),t.watch&&$(t.watch,()=>s.refresh());const _=a.hook("app:data:refresh",o=>{if(!o||o.includes(e))return s.refresh()});i&&S(_)}const c=Promise.resolve(a._asyncDataPromises[e]).then(()=>s);return Object.assign(c,s),c}function le(l,d){const e={};for(const h of d)e[h]=l[h];return e}function ce(l){return{}}const C=l=>(oe("data-v-2f879e9d"),l=l(),ne(),l),de={key:0},ue={key:1,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],pe={ref:"img0",src:R},_e=C(()=>r("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min hidden md:block"},[r("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),he={key:2,class:"flex flex-row justify-center items-center mt-12"},me=["data"],ye={ref:"img1",src:H},ve={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ge=C(()=>r("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),xe=["href"],we={key:1},be={key:0,class:"flex flex-col items-center space-y-4"},ke=C(()=>r("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),Ie={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Pe=["onKeyup"],De={key:1},Ne=C(()=>r("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[r("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Ne],Oe={__name:"[pasteId]",async setup(l){let d,e;const h=Q(),t=G();let{data:a,error:m}=([d,e]=j(async()=>M("paste",async p=>{const b=A().params.pasteId,y=ce().cookie,I={};return y.split(";").forEach(D=>{const E=D.split("=");I[E[0].trim()]=E[1]}),await $fetch(`${re().public.webAddress}/api/paste/${b}`,{headers:{Authorization:"ApiKey "+I.quickpaste_auth},parseResponse:JSON.parse})},{server:!0})),d=await d,e(),d),n=x(a);n.value,m.value&&console.log(m.value);let{data:s}=([d,e]=j(()=>M("error",()=>m.value?m.value.response.status:200,{server:!0})),d=await d,e(),d),k=x(!1);const P=A();let c=x("");function i(){if(h.user()==null||n.value==null||n.value.owner.id!=h.id())return;A().query.edit&&(k.value=!0)}async function _(){if(c.value.length===0){t.addNotification({type:1,title:"Please enter password to view",level:1});return}const p=await fetch(`/api/paste/${P.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(p.ok)n.value=await p.json(),s=0,c.value.length!=0&&(n.value.password=c.value),i(),document.title="Quickpaste | "+n.value.title.substring(0,25);else{switch(p.status){case 401:t.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",s=p.status}}let o=x(0),u=x(void 0);const O=async p=>{o.value=1,n.value=p;const w={"Content-Type":"application/json"};c.value.length!=0&&(w["Paste-Authorization"]=c.value);const b=await fetch(`/api/paste/${P.params.pasteId}`,{method:"PUT",headers:w,credentials:"include",body:JSON.stringify(p)}),y=await b.json();b.ok?(o.value=2,u.value=y.result):(o.value=0,y.result.includes("title")?t.addNotification({title:"Paste title is missing",type:N.NOTIFICATION,level:1}):y.result.includes("name")?t.addNotification({title:"One or more fragments are missing a title",type:N.NOTIFICATION,level:1}):y.result.includes("content")?t.addNotification({title:"One or more fragments are missing content",description:"Please deleate them, or add missing content",type:N.NOTIFICATION,level:1}):t.addNotification({title:"Error accured when creating the paste",description:"Please try again.",type:N.NOTIFICATION,level:1}))};return n.value&&(document.title="Quickpaste | "+n.value.title.substring(0,25)),L(()=>{console.log(n),i()}),(p,w)=>{var I,T;const b=z,y=W("font-awesome-icon");return v(),g("div",null,[f(n)?(v(),g("div",de,[f(o)==0?(v(),X(b,{key:0,onSubmit:O,paste:f(n),editable:f(k),submitText:"Re-Paste !"},null,8,["paste","editable"])):f(o)==1?(v(),g("div",ue,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:f(R)},[r("img",pe,null,512)],8,fe),_e])):(v(),g("div",he,[r("object",{class:"w-100px sm:w-150px md:w-300px",type:"image/svg+xml",data:f(H)},[r("img",ye,null,512)],8,me),r("div",ve,[ge,r("h3",null,[B(" Check it at: "),r("a",{class:"font-bold",href:`/${(I=f(u))==null?void 0:I.pasteId}`},[B(Y((T=f(u))==null?void 0:T.pasteId)+" ",1),Z(y,{icon:["fas","fa-arrow-up-right-from-square"]})],8,xe)])])]))])):(v(),g("div",we,[f(s)==401?(v(),g("div",be,[ke,r("div",Ie,[ee(r("input",{onKeyup:ae(_,["enter"]),"onUpdate:modelValue":w[0]||(w[0]=D=>se(c)?c.value=D:c=D),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Pe),[[te,f(c)]]),r("button",{onClick:_,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(v(),g("div",De,Ce))]))])}}},Se=J(Oe,[["__scopeId","data-v-2f879e9d"]]);export{Se as default};
