import{s as M,a as R,_ as H}from"./logo-paste-created.c30ae58f.js";import{q as K,s as x,v as q,x as E,y as F,u as f,z as $,h as U,A as V,j as J,w as j,C as A,D as Q,k as G,o as g,b as w,c as L,e as r,E as z,t as W,l as X,G as Y,H as Z,I as ee,J as te,N as O,p as ae,f as se,i as oe}from"./entry.62b978ed.js";const ne=()=>null;function B(...l){var c,N,P,v,k,D,d,h,_;const u=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(u);let[a,m,e={}]=l;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof m!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=(c=e.server)!=null?c:!0,e.default=(N=e.default)!=null?N:ne,e.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),e.lazy=(v=(P=e.lazy)!=null?P:e.defer)!=null?v:!1,e.initialCache=(k=e.initialCache)!=null?k:!0,e.immediate=(D=e.immediate)!=null?D:!0;const s=K(),y=()=>(s.isHydrating||e.initialCache)&&s.payload.data[a]!==void 0;s._asyncData[a]||(s._asyncData[a]={data:x(y()?s.payload.data[a]:(h=(d=e.default)==null?void 0:d.call(e))!=null?h:null),pending:x(!y()),error:x((_=s.payload._errors[a])!=null?_:null)});const t={...s._asyncData[a]};t.refresh=t.execute=(o={})=>s._asyncDataPromises[a]?s._asyncDataPromises[a]:o._initial&&y()?s.payload.data[a]:(t.pending.value=!0,s._asyncDataPromises[a]=new Promise((n,i)=>{try{n(m(s))}catch(p){i(p)}}).then(n=>{e.transform&&(n=e.transform(n)),e.pick&&(n=ie(n,e.pick)),t.data.value=n,t.error.value=null}).catch(n=>{var i,p;t.error.value=n,t.data.value=f((p=(i=e.default)==null?void 0:i.call(e))!=null?p:null)}).finally(()=>{t.pending.value=!1,s.payload.data[a]=t.data.value,t.error.value&&(s.payload._errors[a]=!0),delete s._asyncDataPromises[a]}),s._asyncDataPromises[a]);const b=()=>t.refresh({_initial:!0}),C=e.server!==!1&&s.payload.serverRendered;{const o=$();if(o&&!o._nuxtOnBeforeMountCbs){o._nuxtOnBeforeMountCbs=[];const i=o._nuxtOnBeforeMountCbs;o&&(q(()=>{i.forEach(p=>{p()}),i.splice(0,i.length)}),E(()=>i.splice(0,i.length)))}C&&s.isHydrating&&a in s.payload.data?t.pending.value=!1:o&&(s.payload.serverRendered&&s.isHydrating||e.lazy)&&e.immediate?o._nuxtOnBeforeMountCbs.push(b):e.immediate&&b(),e.watch&&F(e.watch,()=>t.refresh());const n=s.hook("app:data:refresh",i=>{if(!i||i.includes(a))return t.refresh()});o&&E(n)}const I=Promise.resolve(s._asyncDataPromises[a]).then(()=>t);return Object.assign(I,t),I}function ie(l,u){const a={};for(const m of u)a[m]=l[m];return a}function re(l){return{}}const T=l=>(ae("data-v-2f879e9d"),l=l(),se(),l),le={key:0},ce={key:1,class:"flex flex-row justify-center items-center mt-12"},de=["data"],ue={ref:"img0",src:M},fe=T(()=>r("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min hidden md:block"},[r("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),pe={key:2,class:"flex flex-row justify-center items-center mt-12"},he=["data"],_e={ref:"img1",src:R},me={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ye=T(()=>r("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),ve=z(" Check it at: "),ge=["href"],xe={key:1},we={key:0,class:"flex flex-col items-center space-y-4"},be=T(()=>r("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),ke={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Ie=["onKeyup"],Ne={key:1},Pe=T(()=>r("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[r("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Pe],De={__name:"[pasteId]",async setup(l){let u,a;const m=V(),e=J();let{data:s,error:y}=([u,a]=j(async()=>B("paste",async d=>{const _=A().params.pasteId,o=re().cookie,n={};return o.split(";").forEach(p=>{const S=p.split("=");n[S[0].trim()]=S[1]}),await $fetch(`${oe().public.webAddress}/api/paste/${_}`,{headers:{Authorization:"ApiKey "+n.quickpaste_auth},parseResponse:JSON.parse})},{server:!0})),u=await u,a(),u),t=x(s);t.value,y.value&&console.log(y.value);let{data:b}=([u,a]=j(()=>B("error",()=>y.value?y.value.response.status:200,{server:!0})),u=await u,a(),u),C=x(!1);const I=A();let c=x("");function N(){if(m.user()==null||t.value==null||t.value.owner.id!=m.id())return;A().query.edit&&(C.value=!0)}async function P(){if(c.value.length===0){e.addNotification({type:1,title:"Please enter password to view",level:1});return}const d=await fetch(`/api/paste/${I.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(d.ok)t.value=await d.json(),b=0,c.value.length!=0&&(t.value.password=c.value),N(),document.title="Quickpaste | "+t.value.title.substring(0,25);else{switch(d.status){case 401:e.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",b=d.status}}let v=x(0),k=x(void 0);const D=async d=>{v.value=1,t.value=d;const h={"Content-Type":"application/json"};c.value.length!=0&&(h["Paste-Authorization"]=c.value);const _=await fetch(`/api/paste/${I.params.pasteId}`,{method:"PUT",headers:h,credentials:"include",body:JSON.stringify(d)}),o=await _.json();_.ok?(v.value=2,k.value=o.result):(v.value=0,o.result.includes("title")?e.addNotification({title:"Paste title is missing",type:O.NOTIFICATION,level:1}):o.result.includes("name")?e.addNotification({title:"One or more fragments are missing a title",type:O.NOTIFICATION,level:1}):o.result.includes("content")?e.addNotification({title:"One or more fragments are missing content",description:"Please deleate them, or add missing content",type:O.NOTIFICATION,level:1}):e.addNotification({title:"Error accured when creating the paste",description:"Please try again.",type:O.NOTIFICATION,level:1}))};return t.value&&(document.title="Quickpaste | "+t.value.title.substring(0,25)),Q(()=>{console.log(t),N()}),(d,h)=>{var n,i;const _=H,o=G("font-awesome-icon");return g(),w("div",null,[f(t)?(g(),w("div",le,[f(v)==0?(g(),L(_,{key:0,onSubmit:D,paste:f(t),editable:f(C),submitText:"Re-Paste !"},null,8,["paste","editable"])):f(v)==1?(g(),w("div",ce,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:f(M)},[r("img",ue,null,512)],8,de),fe])):(g(),w("div",pe,[r("object",{class:"w-100px sm:w-150px md:w-300px",type:"image/svg+xml",data:f(R)},[r("img",_e,null,512)],8,he),r("div",me,[ye,r("h3",null,[ve,r("a",{class:"font-bold",href:`/${(n=f(k))==null?void 0:n.pasteId}`},[z(W((i=f(k))==null?void 0:i.pasteId)+" ",1),X(o,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ge)])])]))])):(g(),w("div",xe,[f(b)==401?(g(),w("div",we,[be,r("div",ke,[Y(r("input",{onKeyup:ee(P,["enter"]),"onUpdate:modelValue":h[0]||(h[0]=p=>te(c)?c.value=p:c=p),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Ie),[[Z,f(c)]]),r("button",{onClick:P,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(g(),w("div",Ne,Ce))]))])}}},Se=U(De,[["__scopeId","data-v-2f879e9d"]]);export{Se as default};
