import{_ as b}from"./UserPanel.5ab4b8bb.mjs";import{z as y,j as P,v as k,k as v,o as a,b as c,l as f,e as t,F as N,r as S,E as _,t as d,c as h,O as p,Q as $,W as M,R as C,N as j}from"./entry.b9949a8e.mjs";const D={class:"flex flex-col md:flex-row w-full justify-between"},I={class:"md:w-4/5"},E=t("h1",{class:"text-5xl mb-6 text-orange text-shadow-sm border-b border-blue pb-4"},"Pastes",-1),O=["href"],R={class:"text-2xl font-bold"},T={class:"text-sm font-normal italic text-gray-500"},B={class:"flex flex-row justify-between"},L=["href"],V=["onClick"],F={key:1,class:"text-center"},H=t("h2",{class:"text-gray-400"},[_("You can create some pastes "),t("a",{href:"/",class:"text-green"},"here")],-1),J=[H],Q={data(){return{pastes:[],nextPageId:void 0,loadingMore:!1}},methods:{async refreshPastes(){const o=await $fetch("/api/user/pastes",{credentials:"include",parseResponse:JSON.json});this.pastes=o.result.pastes,this.nextPageId=o.result.nextPage;for(let s=0;s<this.pastes.length;s++)this.pastes[s].created=new Date(this.pastes[s].created).toLocaleDateString()},async loadMorePastes(){const o=this.$refs["paste-container"],s=o.scrollTop+o.clientHeight;if(this.nextPageId&&s>o.scrollHeight-20&&!this.loadingMore){this.loadingMore=!0;const n=await $fetch(`/api/user/pastes?pageId=${this.nextPageId}`,{credentials:"include",parseResponse:JSON.json});this.nextPageId=n.result.nextPage;for(let r=0;r<n.result.pastes.length;r++)n.result.pastes[r].created=new Date(n.result.pastes[r].created).toLocaleDateString();this.pastes=this.pastes.concat(n.result.pastes),this.loadingMore=!1}}},mounted(){this.pastes.length===0&&this.refreshPastes()}},W=Object.assign(Q,{__name:"index",setup(o){const s=y(),r=P().addNotification,m=k(s.username()),x=async i=>{await r({type:j.CONFIRM,title:"Delete paste?",description:"This action can not be reversed!"})&&(await $fetch(`/api/paste/${i}`,{method:"DELETE",credentials:"include"}),await refreshPastes())};return document.title=`Quickpaste | ${m}`,(i,l)=>{const g=b,u=v("font-awesome-icon"),w=C;return a(),c("div",D,[f(g),t("div",I,[E,i.pastes.length>0?(a(),c("div",{key:0,ref:"paste-container",class:"max-h-prose overflow-y-auto",onScroll:l[0]||(l[0]=(...e)=>i.loadMorePastes&&i.loadMorePastes(...e))},[(a(!0),c(N,null,S(i.pastes,e=>(a(),c("div",{key:e.uuid,class:"flex flex-col md:flex-row justify-between content-cetner mr-2 p-2 px-8 mb-4 rounded bg-blue"},[t("a",{href:`/${e.uuid}`},[t("h3",R,[_(d(e.title)+" ",1),t("span",T,"#"+d(e.uuid),1),e.isPrivate?(a(),h(u,{key:0,icon:["fas","fa-eye-slash"],class:"text-sm ml-2 mb-px"})):p("",!0),e.password?(a(),h(u,{key:1,icon:["fas","fa-lock"],class:"text-sm ml-2 mb-px"})):p("",!0)]),f(w,null,{default:$(()=>[t("p",null,"Created: "+d(e.created),1)]),_:2},1024)],8,O),t("div",B,[t("a",{class:"bg-green flex-1 m-2 rounded p-4 text-center",href:`/${e.uuid}?edit=1`},"Edit",8,L),t("button",{class:"bg-red-600 flex-1 m-2 rounded p-4 text-center",onClick:M(U=>x(e.uuid),["stop"])},"Remove",8,V)])]))),128))],544)):(a(),c("div",F,J))])])}}});export{W as default};
