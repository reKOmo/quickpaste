import{_ as N,a as R,b as z}from"./logo-paste-created.5230a5c0.mjs";import{q as A,s as B,v as I,w as O,x as C,y as T,z as H,u as w,h as q,A as K,j as Q,B as D,k as U,o as h,b as y,c as V,D as G,e as n,m as M,t as J,l as F,E as L,G as W,H as X,I as Y,p as Z,f as ee,J as te,i as se}from"./entry.64de50a4.mjs";const ae=()=>null;function E(...s){var g,_,b,x,k,P,S;const i=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(i);let[e,u,t={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(g=t.server)!=null?g:!0,t.default=(_=t.default)!=null?_:ae,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(x=(b=t.lazy)!=null?b:t.defer)!=null?x:!1,t.initialCache=(k=t.initialCache)!=null?k:!0;const a=A(),o=H();if(o&&!o._nuxtOnBeforeMountCbs){const p=o._nuxtOnBeforeMountCbs=[];o&&(B(()=>{p.forEach(d=>{d()}),p.splice(0,p.length)}),I(()=>p.splice(0,p.length)))}const c=()=>t.initialCache&&a.payload.data[e]!==void 0,r={data:O((P=a.payload.data[e])!=null?P:t.default()),pending:C(!c()),error:C((S=a.payload._errors[e])!=null?S:null)};r.refresh=(p={})=>a._asyncDataPromises[e]?a._asyncDataPromises[e]:p._initial&&c()?a.payload.data[e]:(r.pending.value=!0,a._asyncDataPromises[e]=new Promise((d,j)=>{try{d(u(a))}catch($){j($)}}).then(d=>{t.transform&&(d=t.transform(d)),t.pick&&(d=oe(d,t.pick)),r.data.value=d,r.error.value=null}).catch(d=>{r.error.value=d,r.data.value=w(t.default())}).finally(()=>{r.pending.value=!1,a.payload.data[e]=r.data.value,r.error.value&&(a.payload._errors[e]=!0),delete a._asyncDataPromises[e]}),a._asyncDataPromises[e]);const f=()=>r.refresh({_initial:!0}),l=t.server!==!1&&a.payload.serverRendered;{l&&a.isHydrating&&e in a.payload.data?r.pending.value=!1:o&&a.payload.serverRendered&&(a.isHydrating||t.lazy)?o._nuxtOnBeforeMountCbs.push(f):f(),t.watch&&T(t.watch,()=>r.refresh());const p=a.hook("app:data:refresh",d=>{if(!d||d.includes(e))return r.refresh()});o&&I(p)}const v=Promise.resolve(a._asyncDataPromises[e]).then(()=>r);return Object.assign(v,r),v}function oe(s,i){const e={};for(const u of i)e[u]=s[u];return e}function re(s){return{}}const m=s=>(Z("data-v-4c772ac7"),s=s(),ee(),s),ne={key:0},ie={key:1,class:"flex flex-row justify-center items-center mt-12"},de=m(()=>n("object",{width:"300",height:"300",type:"image/svg+xml",data:"@/assets/animated/logo-paste-loading.svg"},[n("img",{src:R})],-1)),ce=m(()=>n("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[n("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),le=[de,ce],ue={key:2,class:"flex flex-row justify-center items-center mt-12"},pe=m(()=>n("object",{width:"300",height:"300",type:"image/svg+xml",data:"@/assets/animated/logo-paste-created.svg"},[n("img",{src:z})],-1)),fe={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},he=m(()=>n("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),me=M(" Check it at: "),_e=["href"],ye={key:1,class:"flex flex-col items-center space-y-4"},ge=m(()=>n("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),we={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},ve={key:2},be=m(()=>n("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[n("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),xe=[be],ke={data(){return{editMode:!1,password:"",pastePostingState:0,createdPaste:void 0}},mounted(){this.checkEditMode(),this.paste&&(document.title="Quickpaste | "+this.paste.title.substring(0,25))},methods:{checkEditMode(){this.userStore.user()!=null&&(!this.paste||this.paste.owner.id==this.userStore.id()&&this.$route.query.edit&&(this.editMode=!0))},async rePaste(s){this.pastePostingState=1;const i={"Content-Type":"application/json"};this.password.length!=0&&(i["Paste-Authorization"]=this.password);const e=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(s)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)},async reloadPaste(){if(this.password.length===0){this.notificationStore.addNotification({type:1,title:"Please enter password to enter",level:1});return}const s=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":this.password},credentials:"include"});if(s.ok)this.paste=await s.json(),this.password.length!=0&&(this.paste.password=this.password),this.checkEditMode(),document.title="Quickpaste | "+this.paste.title.substring(0,25);else{switch(s.status){case 401:this.notificationStore.addNotification({type:1,title:"Incorrect password",level:1});break}this.password="",this.err=s.status}}}},Pe=Object.assign(ke,{__name:"[pasteId]",async setup(s){let i,e;K(),Q();const{data:u,error:t}=([i,e]=D(async()=>E("paste",async o=>{const r=te().currentRoute.value.params.pasteId,f=re().cookie,l={};return f.split(";").forEach(g=>{const _=g.split("=");l[_[0].trim()]=_[1]}),await $fetch(`${se().internalGatewayAddress}/api/paste/${r}`,{headers:{Authorization:"ApiKey "+l.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),i=await i,e(),i);u.value,t.value&&console.log(t.value);const{data:a}=([i,e]=D(()=>E("error",()=>t.value?t.value.response.status:200,{server:!0},"$nnNzL6MnHs")),i=await i,e(),i);return(o,c)=>{const r=N,f=U("font-awesome-icon");return w(u)?(h(),y("div",ne,[o.pastePostingState==0?(h(),V(r,{key:0,onSubmit:o.rePaste,class:G(["m-auto",{"max-w-4xl":!o.editMode}]),paste:w(u),editable:o.editMode,submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):o.pastePostingState==1?(h(),y("div",ie,le)):(h(),y("div",ue,[pe,n("div",fe,[he,n("h3",null,[me,n("a",{class:"font-bold",href:`/${o.createdPaste.pasteId}`},[M(J(o.createdPaste.pasteId)+" ",1),F(f,{icon:["fas","fa-arrow-up-right-from-square"]})],8,_e)])])]))])):w(a)==401?(h(),y("div",ye,[ge,n("div",we,[L(n("input",{onKeyup:c[0]||(c[0]=X((...l)=>o.reloadPaste&&o.reloadPaste(...l),["enter"])),"onUpdate:modelValue":c[1]||(c[1]=l=>Y(password)?password.value=l:null),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,544),[[W,o.password]]),n("button",{onClick:c[2]||(c[2]=(...l)=>o.reloadPaste&&o.reloadPaste(...l)),class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(h(),y("div",ve,xe))}}}),De=q(Pe,[["__scopeId","data-v-4c772ac7"]]);export{De as default};
