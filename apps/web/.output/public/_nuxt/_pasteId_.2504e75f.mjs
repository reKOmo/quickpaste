import{_ as B,a as O,b as T}from"./logo-paste-created.9a427b16.mjs";import{m as M,q as H,s as N,w as K,v as P,x as U,y as q,u as p,h as V,z as Q,j as J,A as $,B as G,D,k as F,o as g,b as k,c as L,E as W,e as i,G as A,t as X,l as Y,H as Z,I as ee,J as te,K as se,p as ae,f as oe,i as ne}from"./entry.a931cc10.mjs";const re=()=>null;function z(...r){var m,I,l,x,b,n,y;const c=typeof r[r.length-1]=="string"?r.pop():void 0;typeof r[0]!="string"&&r.unshift(c);let[e,f,s={}]=r;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof f!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");s.server=(m=s.server)!=null?m:!0,s.default=(I=s.default)!=null?I:re,s.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),s.lazy=(x=(l=s.lazy)!=null?l:s.defer)!=null?x:!1,s.initialCache=(b=s.initialCache)!=null?b:!0;const a=M(),u=q();if(u&&!u._nuxtOnBeforeMountCbs){const d=u._nuxtOnBeforeMountCbs=[];u&&(H(()=>{d.forEach(o=>{o()}),d.splice(0,d.length)}),N(()=>d.splice(0,d.length)))}const h=()=>s.initialCache&&a.payload.data[e]!==void 0,t={data:K((n=a.payload.data[e])!=null?n:s.default()),pending:P(!h()),error:P((y=a.payload._errors[e])!=null?y:null)};t.refresh=(d={})=>a._asyncDataPromises[e]?a._asyncDataPromises[e]:d._initial&&h()?a.payload.data[e]:(t.pending.value=!0,a._asyncDataPromises[e]=new Promise((o,_)=>{try{o(f(a))}catch(j){_(j)}}).then(o=>{s.transform&&(o=s.transform(o)),s.pick&&(o=ie(o,s.pick)),t.data.value=o,t.error.value=null}).catch(o=>{t.error.value=o,t.data.value=p(s.default())}).finally(()=>{t.pending.value=!1,a.payload.data[e]=t.data.value,t.error.value&&(a.payload._errors[e]=!0),delete a._asyncDataPromises[e]}),a._asyncDataPromises[e]);const v=()=>t.refresh({_initial:!0}),C=s.server!==!1&&a.payload.serverRendered;{C&&a.isHydrating&&e in a.payload.data?t.pending.value=!1:u&&a.payload.serverRendered&&(a.isHydrating||s.lazy)?u._nuxtOnBeforeMountCbs.push(v):v(),s.watch&&U(s.watch,()=>t.refresh());const d=a.hook("app:data:refresh",o=>{if(!o||o.includes(e))return t.refresh()});u&&N(d)}const w=Promise.resolve(a._asyncDataPromises[e]).then(()=>t);return Object.assign(w,t),w}function ie(r,c){const e={};for(const f of c)e[f]=r[f];return e}function ce(r){return{}}const S=r=>(ae("data-v-1ac812bf"),r=r(),oe(),r),de={key:0},le={key:1,class:"flex flex-row justify-center items-center mt-12"},ue=["data"],fe={ref:"img0",src:B},pe=S(()=>i("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[i("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),he={key:2,class:"flex flex-row justify-center items-center mt-12"},_e=["data"],me={ref:"img1",src:O},ye={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ge=S(()=>i("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),ve=A(" Check it at: "),we=["href"],xe={key:1,class:"flex flex-col items-center space-y-4"},be=S(()=>i("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),ke={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Pe=["onKeyup"],Ie={key:2},Se=S(()=>i("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[i("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Se],De={data(){return{pastePostingState:0,createdPaste:void 0}},methods:{async rePaste(r){this.pastePostingState=1;const c={"Content-Type":"application/json"};this.password.length!=0&&(c["Paste-Authorization"]=this.password);const e=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:c,credentials:"include",body:JSON.stringify(r)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)}}},je=Object.assign(De,{__name:"[pasteId]",async setup(r){let c,e;const f=Q(),s=J(),a=s.addNotification;let{data:u,error:h}=([c,e]=$(async()=>z("paste",async n=>{const d=D().params.pasteId,o=ce().cookie,_={};return o.split(";").forEach(R=>{const E=R.split("=");_[E[0].trim()]=E[1]}),await $fetch(`${ne().public.webAddress}/api/paste/${d}`,{headers:{Authorization:"ApiKey "+_.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),c=await c,e(),c),t=G(u),v=P(0);const C=()=>{v.value+=1};t.value,h.value&&console.log(h.value);const{data:w}=([c,e]=$(()=>z("error",()=>h.value?h.value.response.status:200,{server:!0},"$nnNzL6MnHs")),c=await c,e(),c);let m=P(!1);const I=D();let l=P("");function x(){if(f.user()==null||!t.value||t.value.owner.id!=f.id())return;D().query.edit&&(m.value=!0)}async function b(){if(l.value.length===0){s.addNotification({type:1,title:"Please enter password to enter",level:1});return}const n=await fetch(`/api/paste/${I.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":l.value},credentials:"include"});if(n.ok)t=await n.json(),l.length!=0&&(t.password=l),x(),document.title="Quickpaste | "+t.title.substring(0,25),C();else{switch(n.status){case 401:a({type:1,title:"Incorrect password",level:1});break}l="",w=n.status}}return t.value&&(document.title="Quickpaste | "+t.value.title.substring(0,25)),x(),(n,y)=>{const d=T,o=F("font-awesome-icon");return p(t)?(g(),k("div",de,[n.pastePostingState==0?(g(),L(d,{key:p(v),onSubmit:n.rePaste,class:W(["m-auto",{"max-w-4xl":!p(m)}]),paste:p(t),editable:p(m),submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):n.pastePostingState==1?(g(),k("div",le,[i("object",{width:"300",height:"300",type:"image/svg+xml",data:n.$refs.img0.src},[i("img",fe,null,512)],8,ue),pe])):(g(),k("div",he,[i("object",{width:"300",height:"300",type:"image/svg+xml",data:n.$refs.img1.src},[i("img",me,null,512)],8,_e),i("div",ye,[ge,i("h3",null,[ve,i("a",{class:"font-bold",href:`/${n.createdPaste.pasteId}`},[A(X(n.createdPaste.pasteId)+" ",1),Y(o,{icon:["fas","fa-arrow-up-right-from-square"]})],8,we)])])]))])):p(w)==401?(g(),k("div",xe,[be,i("div",ke,[Z(i("input",{onKeyup:te(b,["enter"]),"onUpdate:modelValue":y[0]||(y[0]=_=>se(l)?l.value=_:l=_),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Pe),[[ee,p(l)]]),i("button",{onClick:b,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(g(),k("div",Ie,Ce))}}}),ze=V(je,[["__scopeId","data-v-1ac812bf"]]);export{ze as default};
