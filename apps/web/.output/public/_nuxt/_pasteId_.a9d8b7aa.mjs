import{_ as R,a as j,b as z}from"./logo-paste-created.aeac1965.mjs";import{q as A,s as B,v as C,w as O,x as I,y as T,z as H,u as g,h as q,A as K,j as Q,B as D,k as U,o as h,b as m,c as V,D as G,e as d,m as M,t as J,l as L,E as F,G as W,H as X,I as Y,p as Z,f as ee,J as te,i as se}from"./entry.7d691a2c.mjs";const ae=()=>null;function E(...s){var w,y,b,x,k,P,S;const n=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(n);let[e,u,t={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(w=t.server)!=null?w:!0,t.default=(y=t.default)!=null?y:ae,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(x=(b=t.lazy)!=null?b:t.defer)!=null?x:!1,t.initialCache=(k=t.initialCache)!=null?k:!0;const a=A(),o=H();if(o&&!o._nuxtOnBeforeMountCbs){const p=o._nuxtOnBeforeMountCbs=[];o&&(B(()=>{p.forEach(i=>{i()}),p.splice(0,p.length)}),C(()=>p.splice(0,p.length)))}const l=()=>t.initialCache&&a.payload.data[e]!==void 0,r={data:O((P=a.payload.data[e])!=null?P:t.default()),pending:I(!l()),error:I((S=a.payload._errors[e])!=null?S:null)};r.refresh=(p={})=>a._asyncDataPromises[e]?a._asyncDataPromises[e]:p._initial&&l()?a.payload.data[e]:(r.pending.value=!0,a._asyncDataPromises[e]=new Promise((i,$)=>{try{i(u(a))}catch(N){$(N)}}).then(i=>{t.transform&&(i=t.transform(i)),t.pick&&(i=oe(i,t.pick)),r.data.value=i,r.error.value=null}).catch(i=>{r.error.value=i,r.data.value=g(t.default())}).finally(()=>{r.pending.value=!1,a.payload.data[e]=r.data.value,r.error.value&&(a.payload._errors[e]=!0),delete a._asyncDataPromises[e]}),a._asyncDataPromises[e]);const f=()=>r.refresh({_initial:!0}),c=t.server!==!1&&a.payload.serverRendered;{c&&a.isHydrating&&e in a.payload.data?r.pending.value=!1:o&&a.payload.serverRendered&&(a.isHydrating||t.lazy)?o._nuxtOnBeforeMountCbs.push(f):f(),t.watch&&T(t.watch,()=>r.refresh());const p=a.hook("app:data:refresh",i=>{if(!i||i.includes(e))return r.refresh()});o&&C(p)}const v=Promise.resolve(a._asyncDataPromises[e]).then(()=>r);return Object.assign(v,r),v}function oe(s,n){const e={};for(const u of n)e[u]=s[u];return e}function re(s){return{}}const _=s=>(Z("data-v-3e90de04"),s=s(),ee(),s),ne={key:0},ie={key:1,class:"flex flex-row justify-center items-center mt-12"},de=_(()=>d("img",{width:"300",height:"300",src:j,alt:"Loading"},null,-1)),le=_(()=>d("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[d("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),ce=[de,le],ue={key:2,class:"flex flex-row justify-center items-center mt-12"},pe=_(()=>d("img",{width:"300",height:"300",src:z,alt:"Created"},null,-1)),fe={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},he=_(()=>d("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),_e=M(" Check it at: "),ye=["href"],me={key:1,class:"flex flex-col items-center space-y-4"},we=_(()=>d("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),ge={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},ve={key:2},be=_(()=>d("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[d("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),xe=[be],ke={data(){return{editMode:!1,password:"",pastePostingState:0,createdPaste:void 0}},mounted(){this.checkEditMode(),this.paste&&(document.title="Quickpaste | "+this.paste.title.substring(0,25))},methods:{checkEditMode(){this.userStore.user()!=null&&(!this.paste||this.paste.owner.id==this.userStore.id()&&this.$route.query.edit&&(this.editMode=!0))},async rePaste(s){this.pastePostingState=1;const n={"Content-Type":"application/json"};this.password.length!=0&&(n["Paste-Authorization"]=this.password);const e=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:n,credentials:"include",body:JSON.stringify(s)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)},async reloadPaste(){if(this.password.length===0){this.notificationStore.addNotification({type:1,title:"Please enter password to enter",level:1});return}const s=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":this.password},credentials:"include"});if(s.ok)this.paste=await s.json(),this.password.length!=0&&(this.paste.password=this.password),this.checkEditMode(),document.title="Quickpaste | "+this.paste.title.substring(0,25);else{switch(s.status){case 401:this.notificationStore.addNotification({type:1,title:"Incorrect password",level:1});break}this.password="",this.err=s.status}}}},Pe=Object.assign(ke,{__name:"[pasteId]",async setup(s){let n,e;K(),Q();const{data:u,error:t}=([n,e]=D(async()=>E("paste",async o=>{const r=te().currentRoute.value.params.pasteId,f=re().cookie,c={};return f.split(";").forEach(w=>{const y=w.split("=");c[y[0].trim()]=y[1]}),await $fetch(`${se().internalGatewayAddress}/api/paste/${r}`,{headers:{Authorization:"ApiKey "+c.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),n=await n,e(),n);u.value,t.value&&console.log(t.value);const{data:a}=([n,e]=D(()=>E("error",()=>t.value?t.value.response.status:200,{server:!0},"$nnNzL6MnHs")),n=await n,e(),n);return(o,l)=>{const r=R,f=U("font-awesome-icon");return g(u)?(h(),m("div",ne,[o.pastePostingState==0?(h(),V(r,{key:0,onSubmit:o.rePaste,class:G(["m-auto",{"max-w-4xl":!o.editMode}]),paste:g(u),editable:o.editMode,submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):o.pastePostingState==1?(h(),m("div",ie,ce)):(h(),m("div",ue,[pe,d("div",fe,[he,d("h3",null,[_e,d("a",{class:"font-bold",href:`/${o.createdPaste.pasteId}`},[M(J(o.createdPaste.pasteId)+" ",1),L(f,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ye)])])]))])):g(a)==401?(h(),m("div",me,[we,d("div",ge,[F(d("input",{onKeyup:l[0]||(l[0]=X((...c)=>o.reloadPaste&&o.reloadPaste(...c),["enter"])),"onUpdate:modelValue":l[1]||(l[1]=c=>Y(password)?password.value=c:null),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,544),[[W,o.password]]),d("button",{onClick:l[2]||(l[2]=(...c)=>o.reloadPaste&&o.reloadPaste(...c)),class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(h(),m("div",ve,xe))}}}),De=q(Pe,[["__scopeId","data-v-3e90de04"]]);export{De as default};
