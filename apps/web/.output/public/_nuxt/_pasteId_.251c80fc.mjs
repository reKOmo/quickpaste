import{_ as O,a as T,b as M}from"./logo-paste-created.68faa4f2.mjs";import{m as H,q as K,s as $,w as U,v as m,x as q,y as V,u as f,h as Q,z as J,j as G,A as z,B as F,D as E,k as L,o as g,b as P,c as W,E as X,e as r,G as R,t as Y,l as Z,H as ee,I as te,J as ae,K as se,p as oe,f as ne,i as re}from"./entry.adf4cb79.mjs";const ie=()=>null;function A(...i){var D,c,w,x,_,v,S;const d=typeof i[i.length-1]=="string"?i.pop():void 0;typeof i[0]!="string"&&i.unshift(d);let[t,p,e={}]=i;if(typeof t!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof p!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=(D=e.server)!=null?D:!0,e.default=(c=e.default)!=null?c:ie,e.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),e.lazy=(x=(w=e.lazy)!=null?w:e.defer)!=null?x:!1,e.initialCache=(_=e.initialCache)!=null?_:!0;const a=H(),u=V();if(u&&!u._nuxtOnBeforeMountCbs){const s=u._nuxtOnBeforeMountCbs=[];u&&(K(()=>{s.forEach(o=>{o()}),s.splice(0,s.length)}),$(()=>s.splice(0,s.length)))}const l=()=>e.initialCache&&a.payload.data[t]!==void 0,n={data:U((v=a.payload.data[t])!=null?v:e.default()),pending:m(!l()),error:m((S=a.payload._errors[t])!=null?S:null)};n.refresh=(s={})=>a._asyncDataPromises[t]?a._asyncDataPromises[t]:s._initial&&l()?a.payload.data[t]:(n.pending.value=!0,a._asyncDataPromises[t]=new Promise((o,h)=>{try{o(p(a))}catch(b){h(b)}}).then(o=>{e.transform&&(o=e.transform(o)),e.pick&&(o=ce(o,e.pick)),n.data.value=o,n.error.value=null}).catch(o=>{n.error.value=o,n.data.value=f(e.default())}).finally(()=>{n.pending.value=!1,a.payload.data[t]=n.data.value,n.error.value&&(a.payload._errors[t]=!0),delete a._asyncDataPromises[t]}),a._asyncDataPromises[t]);const I=()=>n.refresh({_initial:!0}),C=e.server!==!1&&a.payload.serverRendered;{C&&a.isHydrating&&t in a.payload.data?n.pending.value=!1:u&&a.payload.serverRendered&&(a.isHydrating||e.lazy)?u._nuxtOnBeforeMountCbs.push(I):I(),e.watch&&q(e.watch,()=>n.refresh());const s=a.hook("app:data:refresh",o=>{if(!o||o.includes(t))return n.refresh()});u&&$(s)}const y=Promise.resolve(a._asyncDataPromises[t]).then(()=>n);return Object.assign(y,n),y}function ce(i,d){const t={};for(const p of d)t[p]=i[p];return t}function le(i){return{}}const j=i=>(oe("data-v-38418c6f"),i=i(),ne(),i),de={key:0},ue={key:1,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],pe={ref:"img0",src:O},he=j(()=>r("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[r("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),_e={key:2,class:"flex flex-row justify-center items-center mt-12"},me=["data"],ye={ref:"img1",src:T},ve={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ge=j(()=>r("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),we=R(" Check it at: "),xe=["href"],be={key:1,class:"flex flex-col items-center space-y-4"},ke=j(()=>r("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),Pe={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Ie=["onKeyup"],Ce={key:2},De=j(()=>r("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[r("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Se=[De],je={data(){return{}},methods:{}},Ee=Object.assign(je,{__name:"[pasteId]",async setup(i){let d,t;const p=J(),e=G();e.addNotification;let{data:a,error:u}=([d,t]=z(async()=>A("paste",async s=>{const h=E().params.pasteId,b=le().cookie,k={};return b.split(";").forEach(B=>{const N=B.split("=");k[N[0].trim()]=N[1]}),await $fetch(`${re().public.webAddress}/api/paste/${h}`,{headers:{Authorization:"ApiKey "+k.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),d=await d,t(),d),l=F(a),n=m(0);const I=()=>{n.value+=1};l.value,u.value&&console.log(u.value);const{data:C}=([d,t]=z(()=>A("error",()=>u.value?u.value.response.status:200,{server:!0},"$nnNzL6MnHs")),d=await d,t(),d);let y=m(!1);const D=E();let c=m("");function w(){if(p.user()==null||!l.value||l.value.owner.id!=p.id())return;E().query.edit&&(y.value=!0)}async function x(){if(c.value.length===0){e.addNotification({type:1,title:"Please enter password to enter",level:1});return}const s=await fetch(`/api/paste/${D.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(s.ok)l=await s.json(),c.value.length!=0&&(l.password=c.value),w(),document.title="Quickpaste | "+l.title.substring(0,25),I();else{switch(s.status){case 401:e.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",C=s.status}}let _=m(0),v=m(void 0);const S=async s=>{_.value=1;const o={"Content-Type":"application/json"};c.value.length!=0&&(o["Paste-Authorization"]=c.value);const h=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:o,credentials:"include",body:JSON.stringify(s)});h.ok&&(_.value=2,v.value=(await h.json()).result)};return l.value&&(document.title="Quickpaste | "+l.value.title.substring(0,25)),w(),(s,o)=>{const h=M,b=L("font-awesome-icon");return f(l)?(g(),P("div",de,[f(_)==0?(g(),W(h,{key:f(n),onSubmit:S,class:X(["m-auto",{"max-w-4xl":!f(y)}]),paste:f(l),editable:f(y),submitText:"Re-Paste !"},null,8,["class","paste","editable"])):f(_)==1?(g(),P("div",ue,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:s.$refs.img0.src},[r("img",pe,null,512)],8,fe),he])):(g(),P("div",_e,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:s.$refs.img1.src},[r("img",ye,null,512)],8,me),r("div",ve,[ge,r("h3",null,[we,r("a",{class:"font-bold",href:`/${f(v).pasteId}`},[R(Y(f(v).pasteId)+" ",1),Z(b,{icon:["fas","fa-arrow-up-right-from-square"]})],8,xe)])])]))])):f(C)==401?(g(),P("div",be,[ke,r("div",Pe,[ee(r("input",{onKeyup:ae(x,["enter"]),"onUpdate:modelValue":o[0]||(o[0]=k=>se(c)?c.value=k:c=k),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Ie),[[te,f(c)]]),r("button",{onClick:x,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(g(),P("div",Ce,Se))}}}),Re=Q(Ee,[["__scopeId","data-v-38418c6f"]]);export{Re as default};
