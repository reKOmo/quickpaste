import{_ as w}from"./UserPanel.86297a69.mjs";import{z as b,j as y,k as P,o as r,b as c,l as h,e as s,F as k,r as v,G as _,t as d,c as p,Q as m,R as N,X as S,S as $,N as M}from"./entry.0da65382.mjs";const C={class:"flex flex-col md:flex-row w-full justify-between"},j={class:"md:w-4/5"},D=s("h1",{class:"text-5xl mb-6 text-orange text-shadow-sm border-b border-blue pb-4"},"Pastes",-1),I=["href"],T={class:"text-2xl font-bold"},E={class:"text-sm font-normal italic text-gray-500"},O={class:"flex flex-row justify-between"},R=["href"],B=["onClick"],L={key:1,class:"text-center"},V=s("h2",{class:"text-gray-400"},[_("You can create some pastes "),s("a",{href:"/",class:"text-green"},"here")],-1),F=[V],H={data(){return{pastes:[],nextPageId:void 0,loadingMore:!1}},methods:{async refreshPastes(){const o=await $fetch("/api/user/pastes",{credentials:"include",parseResponse:JSON.json});this.pastes=o.result.pastes,this.nextPageId=o.result.nextPage;for(let a=0;a<this.pastes.length;a++)this.pastes[a].created=new Date(this.pastes[a].created).toLocaleDateString()},async loadMorePastes(){const o=this.$refs["paste-container"],a=o.scrollTop+o.clientHeight;if(this.nextPageId&&a>o.scrollHeight-20&&!this.loadingMore){this.loadingMore=!0;const n=await $fetch(`/api/user/pastes?pageId=${this.nextPageId}`,{credentials:"include",parseResponse:JSON.json});this.nextPageId=n.result.nextPage;for(let i=0;i<n.result.pastes.length;i++)n.result.pastes[i].created=new Date(n.result.pastes[i].created).toLocaleDateString();this.pastes=this.pastes.concat(n.result.pastes),this.loadingMore=!1}}},mounted(){this.pastes.length===0&&this.refreshPastes()}},z=Object.assign(H,{__name:"index",setup(o){const a=b(),n=y(),i=async e=>{await n.addNotification({type:M.CONFIRM,title:"Delete paste?",description:"This action can not be reversed!"})&&(await $fetch(`/api/paste/${e}`,{method:"DELETE",credentials:"include"}),await refreshPastes())},u=e=>{document.title=`Quickpaste | ${e}`};{let e=a.username();e==""?setTimeout(()=>{let l=a.username();u(l)},200):u(e)}return(e,l)=>{const x=w,f=P("font-awesome-icon"),g=$;return r(),c("div",C,[h(x),s("div",j,[D,e.pastes.length>0?(r(),c("div",{key:0,ref:"paste-container",class:"max-h-prose overflow-y-auto",onScroll:l[0]||(l[0]=(...t)=>e.loadMorePastes&&e.loadMorePastes(...t))},[(r(!0),c(k,null,v(e.pastes,t=>(r(),c("div",{key:t.uuid,class:"flex flex-col md:flex-row justify-between content-cetner mr-2 p-2 px-8 mb-4 rounded bg-blue"},[s("a",{href:`/${t.uuid}`},[s("h3",T,[_(d(t.title)+" ",1),s("span",E,"#"+d(t.uuid),1),t.isPrivate?(r(),p(f,{key:0,icon:["fas","fa-eye-slash"],class:"text-sm ml-2 mb-px"})):m("",!0),t.password?(r(),p(f,{key:1,icon:["fas","fa-lock"],class:"text-sm ml-2 mb-px"})):m("",!0)]),h(g,null,{default:N(()=>[s("p",null,"Created: "+d(t.created),1)]),_:2},1024)],8,I),s("div",O,[s("a",{class:"bg-green flex-1 m-2 rounded p-4 text-center",href:`/${t.uuid}?edit=1`},"Edit",8,R),s("button",{class:"bg-red-600 flex-1 m-2 rounded p-4 text-center",onClick:S(J=>i(t.uuid),["stop"])},"Remove",8,B)])]))),128))],544)):(r(),c("div",L,F))])])}}});export{z as default};
