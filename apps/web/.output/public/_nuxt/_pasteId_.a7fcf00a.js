import{s as B,a as M,_ as q}from"./logo-paste-created.592dfb80.js";import{q as F,s as h,v as $,x as R,y as U,u as p,z as V,i as J,A as Q,j as G,w as z,C as E,D as L,k as W,o as v,b as g,c as X,e as r,E as K,t as Y,l as Z,G as ee,H as te,I as ae,J as se,N as T,p as ne,f as oe,h as ie}from"./entry.e9799e26.js";const re=()=>null;function H(...l){var c,k,I,y,w,P,C,D,d;const u=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(u);let[a,_,e={}]=l;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof _!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=(c=e.server)!=null?c:!0,e.default=(k=e.default)!=null?k:re,e.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),e.lazy=(y=(I=e.lazy)!=null?I:e.defer)!=null?y:!1,e.initialCache=(w=e.initialCache)!=null?w:!0,e.immediate=(P=e.immediate)!=null?P:!0;const s=F(),m=()=>(s.isHydrating||e.initialCache)&&s.payload.data[a]!==void 0;s._asyncData[a]||(s._asyncData[a]={data:h(m()?s.payload.data[a]:(D=(C=e.default)==null?void 0:C.call(e))!=null?D:null),pending:h(!m()),error:h((d=s.payload._errors[a])!=null?d:null)});const t={...s._asyncData[a]};t.refresh=t.execute=(i={})=>s._asyncDataPromises[a]?s._asyncDataPromises[a]:i._initial&&m()?s.payload.data[a]:(t.pending.value=!0,s._asyncDataPromises[a]=new Promise((o,n)=>{try{o(_(s))}catch(f){n(f)}}).then(o=>{e.transform&&(o=e.transform(o)),e.pick&&(o=le(o,e.pick)),t.data.value=o,t.error.value=null}).catch(o=>{var n,f;t.error.value=o,t.data.value=p((f=(n=e.default)==null?void 0:n.call(e))!=null?f:null)}).finally(()=>{t.pending.value=!1,s.payload.data[a]=t.data.value,t.error.value&&(s.payload._errors[a]=!0),delete s._asyncDataPromises[a]}),s._asyncDataPromises[a]);const x=()=>t.refresh({_initial:!0}),N=e.server!==!1&&s.payload.serverRendered;{const i=V();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const n=i._nuxtOnBeforeMountCbs;i&&($(()=>{n.forEach(f=>{f()}),n.splice(0,n.length)}),R(()=>n.splice(0,n.length)))}N&&s.isHydrating&&a in s.payload.data?t.pending.value=!1:i&&(s.payload.serverRendered&&s.isHydrating||e.lazy)&&e.immediate?i._nuxtOnBeforeMountCbs.push(x):e.immediate&&x(),e.watch&&U(e.watch,()=>t.refresh());const o=s.hook("app:data:refresh",n=>{if(!n||n.includes(a))return t.refresh()});i&&R(o)}const b=Promise.resolve(s._asyncDataPromises[a]).then(()=>t);return Object.assign(b,t),b}function le(l,u){const a={};for(const _ of u)a[_]=l[_];return a}function ce(l){return{}}const A=l=>(ne("data-v-b9029652"),l=l(),oe(),l),de={key:0},ue={key:1,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],pe=A(()=>r("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[r("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),he={key:2,class:"flex flex-row justify-center items-center mt-12"},_e=["data"],me={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ye=A(()=>r("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),ve=K(" Check it at: "),ge=["href"],xe={key:1},we={key:0,class:"flex flex-col items-center space-y-4"},be=A(()=>r("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),ke={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Ie=["onKeyup"],Ne={key:1},Pe=A(()=>r("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[r("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Pe],De={__name:"[pasteId]",async setup(l){let u,a;const _=Q(),e=G();let{data:s,error:m}=([u,a]=z(async()=>H("paste",async d=>{const o=E().params.pasteId,n=ce().cookie,f={};return n.split(";").forEach(O=>{const j=O.split("=");f[j[0].trim()]=j[1]}),await $fetch(`${ie().public.webAddress}/api/paste/${o}`,{headers:{Authorization:"ApiKey "+f.quickpaste_auth},parseResponse:JSON.parse})},{server:!0})),u=await u,a(),u),t=h(s);t.value,m.value&&console.log(m.value);let{data:x}=([u,a]=z(()=>H("error",()=>m.value?m.value.response.status:200,{server:!0})),u=await u,a(),u),N=h(!1);const b=E();let c=h("");function k(){if(_.user()==null||t.value==null||t.value.owner.id!=_.id())return;E().query.edit&&(N.value=!0)}async function I(){if(c.value.length===0){e.addNotification({type:1,title:"Please enter password to view",level:1});return}const d=await fetch(`/api/paste/${b.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(d.ok)t.value=await d.json(),x=0,c.value.length!=0&&(t.value.password=c.value),k(),document.title="Quickpaste | "+t.value.title.substring(0,25);else{switch(d.status){case 401:e.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",x=d.status}}let y=h(0),w=h(void 0);const P=h(null),C=h(null),D=async d=>{y.value=1,t.value=d;const i={"Content-Type":"application/json"};c.value.length!=0&&(i["Paste-Authorization"]=c.value);const o=await fetch(`/api/paste/${b.params.pasteId}`,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(d)}),n=await o.json();o.ok?(y.value=2,w.value=n.result):(y.value=0,n.result.includes("title")?e.addNotification({title:"Paste title is missing",type:T.NOTIFICATION,level:1}):n.result.includes("name")?e.addNotification({title:"One or more fragments are missing a title",type:T.NOTIFICATION,level:1}):n.result.includes("content")?e.addNotification({title:"One or more fragments are missing content",description:"Please deleate them, or add missing content",type:T.NOTIFICATION,level:1}):e.addNotification({title:"Error accured when creating the paste",description:"Please try again.",type:T.NOTIFICATION,level:1}))};return t.value&&(document.title="Quickpaste | "+t.value.title.substring(0,25)),L(()=>{console.log(t),k()}),(d,i)=>{var f,S;const o=q,n=W("font-awesome-icon");return v(),g("div",null,[p(t)?(v(),g("div",de,[p(y)==0?(v(),X(o,{key:0,onSubmit:D,paste:p(t),editable:p(N),submitText:"Re-Paste !"},null,8,["paste","editable"])):p(y)==1?(v(),g("div",ue,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:p(B)},[r("img",{ref_key:"img0",ref:P,src:B},null,512)],8,fe),pe])):(v(),g("div",he,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:p(M)},[r("img",{ref_key:"img1",ref:C,src:M},null,512)],8,_e),r("div",me,[ye,r("h3",null,[ve,r("a",{class:"font-bold",href:`/${(f=p(w))==null?void 0:f.pasteId}`},[K(Y((S=p(w))==null?void 0:S.pasteId)+" ",1),Z(n,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ge)])])]))])):(v(),g("div",xe,[p(x)==401?(v(),g("div",we,[be,r("div",ke,[ee(r("input",{onKeyup:ae(I,["enter"]),"onUpdate:modelValue":i[0]||(i[0]=O=>se(c)?c.value=O:c=O),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Ie),[[te,p(c)]]),r("button",{onClick:I,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(v(),g("div",Ne,Ce))]))])}}},Se=J(De,[["__scopeId","data-v-b9029652"]]);export{Se as default};
