import{s as R,a as H,_ as z}from"./logo-paste-created.05d0de02.js";import{l as g,m as K,n as q,q as S,s as F,v as $,h as f,x as U,y as V,_ as Q,z as G,j as J,A as j,B as A,C as L,k as W,c as x,D as X,a as r,d as B,t as Y,b as Z,E as ee,G as te,H as se,I as ae,N,o as v,p as oe,f as ne,i as re}from"./entry.cb013063.js";const ie=()=>null;function M(...l){const d=typeof l[l.length-1]=="string"?l.pop():void 0;typeof l[0]!="string"&&l.unshift(d);let[e,h,t={}]=l;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof h!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=t.server??!0,t.default=t.default??ie,t.lazy=t.lazy??!1,t.immediate=t.immediate??!0;const s=$(),m=()=>s.isHydrating?s.payload.data[e]:s.static.data[e],n=()=>m()!==void 0;s._asyncData[e]||(s._asyncData[e]={data:g(m()??t.default()),pending:g(!n()),error:K(s.payload._errors,e),status:g("idle")});const a={...s._asyncData[e]};a.refresh=a.execute=(i={})=>{if(s._asyncDataPromises[e]){if(i.dedupe===!1)return s._asyncDataPromises[e];s._asyncDataPromises[e].cancelled=!0}if((i._initial||s.isHydrating&&i._initial!==!1)&&n())return m();a.pending.value=!0,a.status.value="pending";const _=new Promise((o,u)=>{try{o(h(s))}catch(O){u(O)}}).then(o=>{if(_.cancelled)return s._asyncDataPromises[e];let u=o;t.transform&&(u=t.transform(o)),t.pick&&(u=le(u,t.pick)),a.data.value=u,a.error.value=null,a.status.value="success"}).catch(o=>{if(_.cancelled)return s._asyncDataPromises[e];a.error.value=o,a.data.value=f(t.default()),a.status.value="error"}).finally(()=>{_.cancelled||(a.pending.value=!1,s.payload.data[e]=a.data.value,a.error.value&&(s.payload._errors[e]=U(a.error.value)),delete s._asyncDataPromises[e])});return s._asyncDataPromises[e]=_,s._asyncDataPromises[e]};const k=()=>a.refresh({_initial:!0}),P=t.server!==!1&&s.payload.serverRendered;{const i=V();if(i&&!i._nuxtOnBeforeMountCbs){i._nuxtOnBeforeMountCbs=[];const o=i._nuxtOnBeforeMountCbs;i&&(q(()=>{o.forEach(u=>{u()}),o.splice(0,o.length)}),S(()=>o.splice(0,o.length)))}P&&s.isHydrating&&n()?(a.pending.value=!1,a.status.value=a.error.value?"error":"success"):i&&(s.payload.serverRendered&&s.isHydrating||t.lazy)&&t.immediate?i._nuxtOnBeforeMountCbs.push(k):t.immediate&&k(),t.watch&&F(t.watch,()=>a.refresh());const _=s.hook("app:data:refresh",o=>{if(!o||o.includes(e))return a.refresh()});i&&S(_)}const c=Promise.resolve(s._asyncDataPromises[e]).then(()=>a);return Object.assign(c,a),c}function le(l,d){const e={};for(const h of d)e[h]=l[h];return e}function ce(l){return{}}const C=l=>(oe("data-v-2f879e9d"),l=l(),ne(),l),de={key:0},ue={key:1,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],pe={ref:"img0",src:R},_e=C(()=>r("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min hidden md:block"},[r("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),he={key:2,class:"flex flex-row justify-center items-center mt-12"},me=["data"],ye={ref:"img1",src:H},ve={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},ge=C(()=>r("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),xe=["href"],we={key:1},be={key:0,class:"flex flex-col items-center space-y-4"},ke=C(()=>r("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),Ie={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},Pe=["onKeyup"],De={key:1},Ne=C(()=>r("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[r("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Ce=[Ne],Oe={__name:"[pasteId]",async setup(l){let d,e;const h=G(),t=J();let{data:s,error:m}=([d,e]=j(async()=>M("paste",async p=>{const b=A().params.pasteId,y=ce().cookie,I={};return y.split(";").forEach(D=>{const E=D.split("=");I[E[0].trim()]=E[1]}),await $fetch(`${re().public.webAddress}/api/paste/${b}`,{headers:{Authorization:"ApiKey "+I.quickpaste_auth},parseResponse:JSON.parse})},{server:!0})),d=await d,e(),d),n=g(s);n.value,m.value&&console.log(m.value);let{data:a}=([d,e]=j(()=>M("error",()=>m.value?m.value.response.status:200,{server:!0})),d=await d,e(),d),k=g(!1);const P=A();let c=g("");function i(){if(h.user()==null||n.value==null||n.value.owner.id!=h.id())return;A().query.edit&&(k.value=!0)}async function _(){if(c.value.length===0){t.addNotification({type:1,title:"Please enter password to view",level:1});return}const p=await fetch(`/api/paste/${P.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":c.value},credentials:"include"});if(p.ok)n.value=await p.json(),a=0,c.value.length!=0&&(n.value.password=c.value),i(),document.title="Quickpaste | "+n.value.title.substring(0,25);else{switch(p.status){case 401:t.addNotification({type:1,title:"Incorrect password",level:1});break}c.value="",a=p.status}}let o=g(0),u=g(void 0);const O=async p=>{o.value=1,n.value=p;const w={"Content-Type":"application/json"};c.value.length!=0&&(w["Paste-Authorization"]=c.value);const b=await fetch(`/api/paste/${P.params.pasteId}`,{method:"PUT",headers:w,credentials:"include",body:JSON.stringify(p)}),y=await b.json();b.ok?(o.value=2,u.value=y.result):(o.value=0,y.result.includes("title")?t.addNotification({title:"Paste title is missing",type:N.NOTIFICATION,level:1}):y.result.includes("name")?t.addNotification({title:"One or more fragments are missing a title",type:N.NOTIFICATION,level:1}):y.result.includes("content")?t.addNotification({title:"One or more fragments are missing content",description:"Please deleate them, or add missing content",type:N.NOTIFICATION,level:1}):t.addNotification({title:"Error accured when creating the paste",description:"Please try again.",type:N.NOTIFICATION,level:1}))};return n.value&&(document.title="Quickpaste | "+n.value.title.substring(0,25)),L(()=>{console.log(n),i()}),(p,w)=>{var I,T;const b=z,y=W("font-awesome-icon");return v(),x("div",null,[f(n)?(v(),x("div",de,[f(o)==0?(v(),X(b,{key:0,onSubmit:O,paste:f(n),editable:f(k),submitText:"Re-Paste !"},null,8,["paste","editable"])):f(o)==1?(v(),x("div",ue,[r("object",{width:"300",height:"300",type:"image/svg+xml",data:f(R)},[r("img",pe,null,512)],8,fe),_e])):(v(),x("div",he,[r("object",{class:"w-100px sm:w-150px md:w-300px",type:"image/svg+xml",data:f(H)},[r("img",ye,null,512)],8,me),r("div",ve,[ge,r("h3",null,[B(" Check it at: "),r("a",{class:"font-bold",href:`/${(I=f(u))==null?void 0:I.pasteId}`},[B(Y((T=f(u))==null?void 0:T.pasteId)+" ",1),Z(y,{icon:["fas","fa-arrow-up-right-from-square"]})],8,xe)])])]))])):(v(),x("div",we,[f(a)==401?(v(),x("div",be,[ke,r("div",Ie,[ee(r("input",{onKeyup:se(_,["enter"]),"onUpdate:modelValue":w[0]||(w[0]=D=>ae(c)?c.value=D:c=D),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,Pe),[[te,f(c)]]),r("button",{onClick:_,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(v(),x("div",De,Ce))]))])}}},Se=Q(Oe,[["__scopeId","data-v-2f879e9d"]]);export{Se as default};
