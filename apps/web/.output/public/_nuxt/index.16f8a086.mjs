import{_}from"./UserPanel.b00c78a1.mjs";import{j as m,A as x,k as g,o as n,b as i,l as d,e as s,F as w,r as b,N as y,m as f,t as l,c as h,O as u,Q as P,V as k,R as v}from"./entry.4998e646.mjs";const N={class:"flex flex-col md:flex-row w-full justify-between"},S={class:"md:w-4/5"},$=s("h1",{class:"text-5xl mb-6 text-orange text-shadow-sm border-b border-blue pb-4"},"Pastes",-1),M=["href"],C={class:"text-2xl font-bold"},j={class:"text-sm font-normal italic text-gray-500"},D={class:"flex flex-row justify-between"},I=["href"],O=["onClick"],E={key:1,class:"text-center"},R=s("h2",{class:"text-gray-400"},[f("You can create some pastes "),s("a",{href:"/",class:"text-green"},"here")],-1),T=[R],V={data(){return{pastes:[],nextPageId:void 0,loadingMore:!1}},methods:{async deletePaste(a){await this.notificationStore.addNotification({type:y.CONFIRM,title:"Delete paste?",description:"This action can not be reversed!"})&&(await $fetch(`/api/paste/${a}`,{method:"DELETE",credentials:"include"}),await this.refreshPastes())},async refreshPastes(){const a=await $fetch("/api/user/pastes",{credentials:"include",parseResponse:JSON.json});this.pastes=a.result.pastes,this.nextPageId=a.result.nextPage;for(let e=0;e<this.pastes.length;e++)this.pastes[e].created=new Date(this.pastes[e].created).toLocaleDateString()},async loadMorePastes(){const a=this.$refs["paste-container"],e=a.scrollTop+a.clientHeight;if(this.nextPageId&&e>a.scrollHeight-20&&!this.loadingMore){this.loadingMore=!0;const o=await $fetch(`/api/user/pastes?pageId=${this.nextPageId}`,{credentials:"include",parseResponse:JSON.json});this.nextPageId=o.result.nextPage;for(let r=0;r<o.result.pastes.length;r++)o.result.pastes[r].created=new Date(o.result.pastes[r].created).toLocaleDateString();this.pastes=this.pastes.concat(o.result.pastes),this.loadingMore=!1}}},mounted(){document.title=`Quickpaste | ${this.userStore.username()}`,this.pastes.length===0&&this.refreshPastes()}},A=Object.assign(V,{__name:"index",setup(a){return m(),x(),(e,o)=>{const r=_,c=g("font-awesome-icon"),p=v;return n(),i("div",N,[d(r),s("div",S,[$,e.pastes.length>0?(n(),i("div",{key:0,ref:"paste-container",class:"max-h-prose overflow-y-auto",onScroll:o[0]||(o[0]=(...t)=>e.loadMorePastes&&e.loadMorePastes(...t))},[(n(!0),i(w,null,b(e.pastes,t=>(n(),i("div",{key:t.uuid,class:"flex flex-col md:flex-row justify-between content-cetner mr-2 p-2 px-8 mb-4 rounded bg-blue"},[s("a",{href:`/${t.uuid}`},[s("h3",C,[f(l(t.title)+" ",1),s("span",j,"#"+l(t.uuid),1),t.isPrivate?(n(),h(c,{key:0,icon:["fas","fa-eye-slash"],class:"text-sm ml-2 mb-px"})):u("",!0),t.password?(n(),h(c,{key:1,icon:["fas","fa-lock"],class:"text-sm ml-2 mb-px"})):u("",!0)]),d(p,null,{default:P(()=>[s("p",null,"Created: "+l(t.created),1)]),_:2},1024)],8,M),s("div",D,[s("a",{class:"bg-green flex-1 m-2 rounded p-4 text-center",href:`/${t.uuid}?edit=1`},"Edit",8,I),s("button",{class:"bg-red-600 flex-1 m-2 rounded p-4 text-center",onClick:k(B=>e.deletePaste(t.uuid),["stop"])},"Remove",8,O)])]))),128))],544)):(n(),i("div",E,T))])])}}});export{A as default};
