import{_ as g}from"./UserPanel.41d3c419.mjs";import{h as w,z as b,j as y,N as P,k,o,b as i,l as u,e as s,F as v,r as N,D as _,t as l,c as f,O as p,Q as S,V as D,R as M}from"./entry.4b0e2bbd.mjs";const $={data(){return{pastes:[],nextPageId:void 0,loadingMore:!1}},asyncData({$pinia:e}){b(e),y()},methods:{async deletePaste(e){await this.notificationStore.addNotification({type:P.CONFIRM,title:"Delete paste?",description:"This action can not be reversed!"})&&(await $fetch(`/api/paste/${e}`,{method:"DELETE",credentials:"include"}),await this.refreshPastes())},async refreshPastes(){const e=await $fetch("/api/user/pastes",{credentials:"include",parseResponse:JSON.json});this.pastes=e.result.pastes,this.nextPageId=e.result.nextPage;for(let a=0;a<this.pastes.length;a++)this.pastes[a].created=new Date(this.pastes[a].created).toLocaleDateString()},async loadMorePastes(){const e=this.$refs["paste-container"],a=e.scrollTop+e.clientHeight;if(this.nextPageId&&a>e.scrollHeight-20&&!this.loadingMore){this.loadingMore=!0;const n=await $fetch(`/api/user/pastes?pageId=${this.nextPageId}`,{credentials:"include",parseResponse:JSON.json});this.nextPageId=n.result.nextPage;for(let r=0;r<n.result.pastes.length;r++)n.result.pastes[r].created=new Date(n.result.pastes[r].created).toLocaleDateString();this.pastes=this.pastes.concat(n.result.pastes),this.loadingMore=!1}}},mounted(){document.title=`Quickpaste | ${this.userStore.username()}`,this.pastes.length===0&&this.refreshPastes()}},C={class:"flex flex-col md:flex-row w-full justify-between"},I={class:"md:w-4/5"},j=s("h1",{class:"text-5xl mb-6 text-orange text-shadow-sm border-b border-blue pb-4"},"Pastes",-1),E=["href"],O={class:"text-2xl font-bold"},R={class:"text-sm font-normal italic text-gray-500"},T={class:"flex flex-row justify-between"},V=["href"],B=["onClick"],L={key:1,class:"text-center"},F=s("h2",{class:"text-gray-400"},[_("You can create some pastes "),s("a",{href:"/",class:"text-green"},"here")],-1),H=[F];function J(e,a,n,r,d,c){const x=g,h=k("font-awesome-icon"),m=M;return o(),i("div",C,[u(x),s("div",I,[j,d.pastes.length>0?(o(),i("div",{key:0,ref:"paste-container",class:"max-h-prose overflow-y-auto",onScroll:a[0]||(a[0]=(...t)=>c.loadMorePastes&&c.loadMorePastes(...t))},[(o(!0),i(v,null,N(d.pastes,t=>(o(),i("div",{key:t.uuid,class:"flex flex-col md:flex-row justify-between content-cetner mr-2 p-2 px-8 mb-4 rounded bg-blue"},[s("a",{href:`/${t.uuid}`},[s("h3",O,[_(l(t.title)+" ",1),s("span",R,"#"+l(t.uuid),1),t.isPrivate?(o(),f(h,{key:0,icon:["fas","fa-eye-slash"],class:"text-sm ml-2 mb-px"})):p("",!0),t.password?(o(),f(h,{key:1,icon:["fas","fa-lock"],class:"text-sm ml-2 mb-px"})):p("",!0)]),u(m,null,{default:S(()=>[s("p",null,"Created: "+l(t.created),1)]),_:2},1024)],8,E),s("div",T,[s("a",{class:"bg-green flex-1 m-2 rounded p-4 text-center",href:`/${t.uuid}?edit=1`},"Edit",8,V),s("button",{class:"bg-red-600 flex-1 m-2 rounded p-4 text-center",onClick:D(Q=>c.deletePaste(t.uuid),["stop"])},"Remove",8,B)])]))),128))],544)):(o(),i("div",L,H))])])}const A=w($,[["render",J]]);export{A as default};
