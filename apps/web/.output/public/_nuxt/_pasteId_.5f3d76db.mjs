import{_ as N,a as R,b as z}from"./logo-paste-created.24b7c205.mjs";import{m as A,q as B,s as I,w as O,v as C,x as T,y as H,u as g,h as q,z as K,j as Q,A as D,k as U,o as h,b as _,c as V,C as G,e as n,D as $,t as J,l as F,E as L,G as W,H as X,I as Y,p as Z,f as ee,J as te,i as se}from"./entry.8bcf9037.mjs";const ae=()=>null;function E(...a){var y,m,b,x,k,P,S;const i=typeof a[a.length-1]=="string"?a.pop():void 0;typeof a[0]!="string"&&a.unshift(i);let[e,u,t={}]=a;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(y=t.server)!=null?y:!0,t.default=(m=t.default)!=null?m:ae,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(x=(b=t.lazy)!=null?b:t.defer)!=null?x:!1,t.initialCache=(k=t.initialCache)!=null?k:!0;const o=A(),s=H();if(s&&!s._nuxtOnBeforeMountCbs){const p=s._nuxtOnBeforeMountCbs=[];s&&(B(()=>{p.forEach(d=>{d()}),p.splice(0,p.length)}),I(()=>p.splice(0,p.length)))}const c=()=>t.initialCache&&o.payload.data[e]!==void 0,r={data:O((P=o.payload.data[e])!=null?P:t.default()),pending:C(!c()),error:C((S=o.payload._errors[e])!=null?S:null)};r.refresh=(p={})=>o._asyncDataPromises[e]?o._asyncDataPromises[e]:p._initial&&c()?o.payload.data[e]:(r.pending.value=!0,o._asyncDataPromises[e]=new Promise((d,M)=>{try{d(u(o))}catch(j){M(j)}}).then(d=>{t.transform&&(d=t.transform(d)),t.pick&&(d=oe(d,t.pick)),r.data.value=d,r.error.value=null}).catch(d=>{r.error.value=d,r.data.value=g(t.default())}).finally(()=>{r.pending.value=!1,o.payload.data[e]=r.data.value,r.error.value&&(o.payload._errors[e]=!0),delete o._asyncDataPromises[e]}),o._asyncDataPromises[e]);const f=()=>r.refresh({_initial:!0}),l=t.server!==!1&&o.payload.serverRendered;{l&&o.isHydrating&&e in o.payload.data?r.pending.value=!1:s&&o.payload.serverRendered&&(o.isHydrating||t.lazy)?s._nuxtOnBeforeMountCbs.push(f):f(),t.watch&&T(t.watch,()=>r.refresh());const p=o.hook("app:data:refresh",d=>{if(!d||d.includes(e))return r.refresh()});s&&I(p)}const v=Promise.resolve(o._asyncDataPromises[e]).then(()=>r);return Object.assign(v,r),v}function oe(a,i){const e={};for(const u of i)e[u]=a[u];return e}function re(a){return{}}const w=a=>(Z("data-v-030a364f"),a=a(),ee(),a),ne={key:0},ie={key:1,class:"flex flex-row justify-center items-center mt-12"},de=["data"],ce={ref:"img0",src:N},le=w(()=>n("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[n("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),ue={key:2,class:"flex flex-row justify-center items-center mt-12"},pe=["data"],fe={ref:"img1",src:R},he={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},me=w(()=>n("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),_e=$(" Check it at: "),ye=["href"],ge={key:1,class:"flex flex-col items-center space-y-4"},we=w(()=>n("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),ve={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},be={key:2},xe=w(()=>n("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[n("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),ke=[xe],Pe={data(){return{editMode:!1,password:"",pastePostingState:0,createdPaste:void 0}},mounted(){this.checkEditMode(),this.paste&&(document.title="Quickpaste | "+this.paste.title.substring(0,25))},methods:{checkEditMode(){this.userStore.user()!=null&&(!this.paste||this.paste.owner.id==this.userStore.id()&&this.$route.query.edit&&(this.editMode=!0))},async rePaste(a){this.pastePostingState=1;const i={"Content-Type":"application/json"};this.password.length!=0&&(i["Paste-Authorization"]=this.password);const e=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(a)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)},async reloadPaste(){if(this.password.length===0){this.notificationStore.addNotification({type:1,title:"Please enter password to enter",level:1});return}const a=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":this.password},credentials:"include"});if(a.ok)this.paste=await a.json(),this.password.length!=0&&(this.paste.password=this.password),this.checkEditMode(),document.title="Quickpaste | "+this.paste.title.substring(0,25);else{switch(a.status){case 401:this.notificationStore.addNotification({type:1,title:"Incorrect password",level:1});break}this.password="",this.err=a.status}}}},Se=Object.assign(Pe,{__name:"[pasteId]",async setup(a){let i,e;K(),Q();const{data:u,error:t}=([i,e]=D(async()=>E("paste",async s=>{const r=te().currentRoute.value.params.pasteId,f=re().cookie,l={};return f.split(";").forEach(y=>{const m=y.split("=");l[m[0].trim()]=m[1]}),await $fetch(`${se().internalGatewayAddress}/api/paste/${r}`,{headers:{Authorization:"ApiKey "+l.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),i=await i,e(),i);u.value,t.value&&console.log(t.value);const{data:o}=([i,e]=D(()=>E("error",()=>t.value?t.value.response.status:200,{server:!0},"$nnNzL6MnHs")),i=await i,e(),i);return(s,c)=>{const r=z,f=U("font-awesome-icon");return g(u)?(h(),_("div",ne,[s.pastePostingState==0?(h(),V(r,{key:0,onSubmit:s.rePaste,class:G(["m-auto",{"max-w-4xl":!s.editMode}]),paste:g(u),editable:s.editMode,submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):s.pastePostingState==1?(h(),_("div",ie,[n("object",{width:"300",height:"300",type:"image/svg+xml",data:s.$refs.img0.src},[n("img",ce,null,512)],8,de),le])):(h(),_("div",ue,[n("object",{width:"300",height:"300",type:"image/svg+xml",data:s.$refs.img1.src},[n("img",fe,null,512)],8,pe),n("div",he,[me,n("h3",null,[_e,n("a",{class:"font-bold",href:`/${s.createdPaste.pasteId}`},[$(J(s.createdPaste.pasteId)+" ",1),F(f,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ye)])])]))])):g(o)==401?(h(),_("div",ge,[we,n("div",ve,[L(n("input",{onKeyup:c[0]||(c[0]=X((...l)=>s.reloadPaste&&s.reloadPaste(...l),["enter"])),"onUpdate:modelValue":c[1]||(c[1]=l=>Y(password)?password.value=l:null),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,544),[[W,s.password]]),n("button",{onClick:c[2]||(c[2]=(...l)=>s.reloadPaste&&s.reloadPaste(...l)),class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(h(),_("div",be,ke))}}}),Ee=q(Se,[["__scopeId","data-v-030a364f"]]);export{Ee as default};
