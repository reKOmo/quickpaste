import{_ as R,a as B,b as O}from"./logo-paste-created.b1ece8a6.mjs";import{m as T,q as M,s as j,w as H,v as D,x as K,y as N,u as y,h as q,z as U,j as Q,A as E,C,k as V,o as w,b as k,c as J,D as G,e as c,E as z,t as F,l as L,G as W,H as X,I as Y,J as Z,p as ee,f as te,i as se}from"./entry.4f1d61c0.mjs";const ae=()=>null;function $(...r){var x,b,n,p,u,v,_;const d=typeof r[r.length-1]=="string"?r.pop():void 0;typeof r[0]!="string"&&r.unshift(d);let[e,h,t={}]=r;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof h!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(x=t.server)!=null?x:!0,t.default=(b=t.default)!=null?b:ae,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(p=(n=t.lazy)!=null?n:t.defer)!=null?p:!1,t.initialCache=(u=t.initialCache)!=null?u:!0;const s=T(),a=N();if(a&&!a._nuxtOnBeforeMountCbs){const f=a._nuxtOnBeforeMountCbs=[];a&&(M(()=>{f.forEach(i=>{i()}),f.splice(0,f.length)}),j(()=>f.splice(0,f.length)))}const m=()=>t.initialCache&&s.payload.data[e]!==void 0,o={data:H((v=s.payload.data[e])!=null?v:t.default()),pending:D(!m()),error:D((_=s.payload._errors[e])!=null?_:null)};o.refresh=(f={})=>s._asyncDataPromises[e]?s._asyncDataPromises[e]:f._initial&&m()?s.payload.data[e]:(o.pending.value=!0,s._asyncDataPromises[e]=new Promise((i,P)=>{try{i(h(s))}catch(A){P(A)}}).then(i=>{t.transform&&(i=t.transform(i)),t.pick&&(i=oe(i,t.pick)),o.data.value=i,o.error.value=null}).catch(i=>{o.error.value=i,o.data.value=y(t.default())}).finally(()=>{o.pending.value=!1,s.payload.data[e]=o.data.value,o.error.value&&(s.payload._errors[e]=!0),delete s._asyncDataPromises[e]}),s._asyncDataPromises[e]);const g=()=>o.refresh({_initial:!0}),I=t.server!==!1&&s.payload.serverRendered;{I&&s.isHydrating&&e in s.payload.data?o.pending.value=!1:a&&s.payload.serverRendered&&(s.isHydrating||t.lazy)?a._nuxtOnBeforeMountCbs.push(g):g(),t.watch&&K(t.watch,()=>o.refresh());const f=s.hook("app:data:refresh",i=>{if(!i||i.includes(e))return o.refresh()});a&&j(f)}const l=Promise.resolve(s._asyncDataPromises[e]).then(()=>o);return Object.assign(l,o),l}function oe(r,d){const e={};for(const h of d)e[h]=r[h];return e}function ne(r){return{}}const S=r=>(ee("data-v-39b55880"),r=r(),te(),r),re={key:0},ie={key:1,class:"flex flex-row justify-center items-center mt-12"},ce=["data"],de={ref:"img0",src:R},le=S(()=>c("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[c("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),ue={key:2,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],pe={ref:"img1",src:B},he={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},_e=S(()=>c("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),me=z(" Check it at: "),ye=["href"],ge={key:1,class:"flex flex-col items-center space-y-4"},ve=S(()=>c("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),we={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},xe=["onKeyup"],be={key:2},ke=S(()=>c("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[c("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Pe=[ke],Se={data(){return{pastePostingState:0,createdPaste:void 0}},methods:{async rePaste(r){this.pastePostingState=1;const d={"Content-Type":"application/json"};this.password.length!=0&&(d["Paste-Authorization"]=this.password);const e=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:d,credentials:"include",body:JSON.stringify(r)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)}}},Ie=Object.assign(Se,{__name:"[pasteId]",async setup(r){let d,e;const h=U(),s=Q().addNotification;let{data:a,error:m}=([d,e]=E(async()=>$("paste",async n=>{const u=C().params.pasteId,v=ne().cookie,_={};return v.split(";").forEach(i=>{const P=i.split("=");_[P[0].trim()]=P[1]}),await $fetch(`${se().public.webAddress}/api/paste/${u}`,{headers:{Authorization:"ApiKey "+_.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),d=await d,e(),d);a.value,m.value&&console.log(m.value);const{data:o}=([d,e]=E(()=>$("error",()=>m.value?m.value.response.status:200,{server:!0},"$nnNzL6MnHs")),d=await d,e(),d);let g=D(!1);const I=C();let l="";function x(){if(h.user()==null||!a.value||a.value.owner.id!=h.id())return;C().query.edit&&(g=!0)}async function b(){var p;if(l.length===0){s({type:1,title:"Please enter password to enter",level:1});return}const n=await fetch(`/api/paste/${I.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":l},credentials:"include"});if(n.ok){a=await n.json(),l.length!=0&&(a.password=l),x(),document.title="Quickpaste | "+a.title.substring(0,25);const u=N();(p=u==null?void 0:u.proxy)==null||p.$forceUpdate()}else{switch(n.status){case 401:s({type:1,title:"Incorrect password",level:1});break}l="",o=n.status}}return a.value&&(document.title="Quickpaste | "+a.value.title.substring(0,25)),x(),(n,p)=>{const u=O,v=V("font-awesome-icon");return y(a)?(w(),k("div",re,[n.pastePostingState==0?(w(),J(u,{key:0,onSubmit:n.rePaste,class:G(["m-auto",{"max-w-4xl":!y(g)}]),paste:y(a),editable:y(g),submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):n.pastePostingState==1?(w(),k("div",ie,[c("object",{width:"300",height:"300",type:"image/svg+xml",data:n.$refs.img0.src},[c("img",de,null,512)],8,ce),le])):(w(),k("div",ue,[c("object",{width:"300",height:"300",type:"image/svg+xml",data:n.$refs.img1.src},[c("img",pe,null,512)],8,fe),c("div",he,[_e,c("h3",null,[me,c("a",{class:"font-bold",href:`/${n.createdPaste.pasteId}`},[z(F(n.createdPaste.pasteId)+" ",1),L(v,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ye)])])]))])):y(o)==401?(w(),k("div",ge,[ve,c("div",we,[W(c("input",{onKeyup:Y(b,["enter"]),"onUpdate:modelValue":p[0]||(p[0]=_=>Z(l)?l.value=_:l=_),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,40,xe),[[X,y(l)]]),c("button",{onClick:b,class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(w(),k("div",be,Pe))}}}),Ee=q(Ie,[["__scopeId","data-v-39b55880"]]);export{Ee as default};
