import{_ as N,a as z,b as A}from"./logo-paste-created.66c6dc14.mjs";import{m as M,q as B,s as C,w as O,v as P,x as T,y as H,u as g,h as K,z as q,j as Q,A as D,k as U,o as y,b as v,c as V,C as G,e as n,D as $,t as J,l as F,E as L,G as W,H as X,I as Y,J as Z,p as ee,f as te,K as se,i as ae}from"./entry.a865d103.mjs";const oe=()=>null;function E(...a){var _,c,k,b,w,S,I;const i=typeof a[a.length-1]=="string"?a.pop():void 0;typeof a[0]!="string"&&a.unshift(i);let[t,f,e={}]=a;if(typeof t!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof f!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");e.server=(_=e.server)!=null?_:!0,e.default=(c=e.default)!=null?c:oe,e.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),e.lazy=(b=(k=e.lazy)!=null?k:e.defer)!=null?b:!1,e.initialCache=(w=e.initialCache)!=null?w:!0;const s=M(),l=H();if(l&&!l._nuxtOnBeforeMountCbs){const p=l._nuxtOnBeforeMountCbs=[];l&&(B(()=>{p.forEach(d=>{d()}),p.splice(0,p.length)}),C(()=>p.splice(0,p.length)))}const h=()=>e.initialCache&&s.payload.data[t]!==void 0,o={data:O((S=s.payload.data[t])!=null?S:e.default()),pending:P(!h()),error:P((I=s.payload._errors[t])!=null?I:null)};o.refresh=(p={})=>s._asyncDataPromises[t]?s._asyncDataPromises[t]:p._initial&&h()?s.payload.data[t]:(o.pending.value=!0,s._asyncDataPromises[t]=new Promise((d,j)=>{try{d(f(s))}catch(R){j(R)}}).then(d=>{e.transform&&(d=e.transform(d)),e.pick&&(d=re(d,e.pick)),o.data.value=d,o.error.value=null}).catch(d=>{o.error.value=d,o.data.value=g(e.default())}).finally(()=>{o.pending.value=!1,s.payload.data[t]=o.data.value,o.error.value&&(s.payload._errors[t]=!0),delete s._asyncDataPromises[t]}),s._asyncDataPromises[t]);const r=()=>o.refresh({_initial:!0}),u=e.server!==!1&&s.payload.serverRendered;{u&&s.isHydrating&&t in s.payload.data?o.pending.value=!1:l&&s.payload.serverRendered&&(s.isHydrating||e.lazy)?l._nuxtOnBeforeMountCbs.push(r):r(),e.watch&&T(e.watch,()=>o.refresh());const p=s.hook("app:data:refresh",d=>{if(!d||d.includes(t))return o.refresh()});l&&C(p)}const m=Promise.resolve(s._asyncDataPromises[t]).then(()=>o);return Object.assign(m,o),m}function re(a,i){const t={};for(const f of i)t[f]=a[f];return t}function ne(a){return{}}const x=a=>(ee("data-v-ec63b533"),a=a(),te(),a),ie={key:0},de={key:1,class:"flex flex-row justify-center items-center mt-12"},ce=["data"],le={ref:"img0",src:N},ue=x(()=>n("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[n("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),pe={key:2,class:"flex flex-row justify-center items-center mt-12"},fe=["data"],he={ref:"img1",src:z},me={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},_e=x(()=>n("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),ye=$(" Check it at: "),ge=["href"],we={key:1,class:"flex flex-col items-center space-y-4"},ve=x(()=>n("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),be={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},xe={key:2},ke=x(()=>n("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[n("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),Pe=[ke],Se={data(){return{password:"",pastePostingState:0,createdPaste:void 0}},mounted(){this.checkEditMode()},methods:{async rePaste(a){this.pastePostingState=1;const i={"Content-Type":"application/json"};this.password.length!=0&&(i["Paste-Authorization"]=this.password);const t=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:i,credentials:"include",body:JSON.stringify(a)});t.ok&&(this.pastePostingState=2,this.createdPaste=(await t.json()).result)},async reloadPaste(){if(this.password.length===0){this.notificationStore.addNotification({type:1,title:"Please enter password to enter",level:1});return}const a=await fetch(`/api/paste/${this.$route.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":this.password},credentials:"include"});if(a.ok)this.paste=await a.json(),this.password.length!=0&&(this.paste.password=this.password),this.checkEditMode(),document.title="Quickpaste | "+this.paste.title.substring(0,25);else{switch(a.status){case 401:this.notificationStore.addNotification({type:1,title:"Incorrect password",level:1});break}this.password="",this.err=a.status}}}},Ie=Object.assign(Se,{__name:"[pasteId]",async setup(a){let i,t;const f=q();Q();const{data:e,error:s}=([i,t]=D(async()=>E("paste",async r=>{const m=se().currentRoute.value.params.pasteId,_=ne().cookie,c={};return _.split(";").forEach(b=>{const w=b.split("=");c[w[0].trim()]=w[1]}),await $fetch(`${ae().internalGatewayAddress}/api/paste/${m}`,{headers:{Authorization:"ApiKey "+c.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),i=await i,t(),i);e.value,s.value&&console.log(s.value);const{data:l}=([i,t]=D(()=>E("error",()=>s.value?s.value.response.status:200,{server:!0},"$nnNzL6MnHs")),i=await i,t(),i);let h=P(!1);function o(){if(f.user()==null||!e.value||e.value.owner.id!=f.id())return;Z().query.edit&&(h=!0)}return e.value&&(document.title="Quickpaste | "+e.value.title.substring(0,25)),o(),(r,u)=>{const m=A,_=U("font-awesome-icon");return g(e)?(y(),v("div",ie,[r.pastePostingState==0?(y(),V(m,{key:0,onSubmit:r.rePaste,class:G(["m-auto",{"max-w-4xl":!g(h)}]),paste:g(e),editable:g(h),submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):r.pastePostingState==1?(y(),v("div",de,[n("object",{width:"300",height:"300",type:"image/svg+xml",data:r.$refs.img0.src},[n("img",le,null,512)],8,ce),ue])):(y(),v("div",pe,[n("object",{width:"300",height:"300",type:"image/svg+xml",data:r.$refs.img1.src},[n("img",he,null,512)],8,fe),n("div",me,[_e,n("h3",null,[ye,n("a",{class:"font-bold",href:`/${r.createdPaste.pasteId}`},[$(J(r.createdPaste.pasteId)+" ",1),F(_,{icon:["fas","fa-arrow-up-right-from-square"]})],8,ge)])])]))])):g(l)==401?(y(),v("div",we,[ve,n("div",be,[L(n("input",{onKeyup:u[0]||(u[0]=X((...c)=>r.reloadPaste&&r.reloadPaste(...c),["enter"])),"onUpdate:modelValue":u[1]||(u[1]=c=>Y(password)?password.value=c:null),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,544),[[W,r.password]]),n("button",{onClick:u[2]||(u[2]=(...c)=>r.reloadPaste&&r.reloadPaste(...c)),class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(y(),v("div",xe,Pe))}}}),$e=K(Ie,[["__scopeId","data-v-ec63b533"]]);export{$e as default};
