import{_ as R}from"./PasteEditor.b2fb1e3b.mjs";import{q as j,s as z,v as C,w as A,x as I,y as B,z as O,u as g,h as T,A as H,j as q,B as D,k as K,o as h,b as m,c as Q,D as U,e as d,m as M,t as V,l as G,E as J,G as L,H as F,I as W,p as X,f as Y,J as Z,i as ee}from"./entry.7ef94d9d.mjs";const te=()=>null;function E(...s){var w,_,b,x,k,P,S;const n=typeof s[s.length-1]=="string"?s.pop():void 0;typeof s[0]!="string"&&s.unshift(n);let[e,u,t={}]=s;if(typeof e!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof u!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");t.server=(w=t.server)!=null?w:!0,t.default=(_=t.default)!=null?_:te,t.defer&&console.warn("[useAsyncData] `defer` has been renamed to `lazy`. Support for `defer` will be removed in RC."),t.lazy=(x=(b=t.lazy)!=null?b:t.defer)!=null?x:!1,t.initialCache=(k=t.initialCache)!=null?k:!0;const a=j(),o=O();if(o&&!o._nuxtOnBeforeMountCbs){const p=o._nuxtOnBeforeMountCbs=[];o&&(z(()=>{p.forEach(i=>{i()}),p.splice(0,p.length)}),C(()=>p.splice(0,p.length)))}const l=()=>t.initialCache&&a.payload.data[e]!==void 0,r={data:A((P=a.payload.data[e])!=null?P:t.default()),pending:I(!l()),error:I((S=a.payload._errors[e])!=null?S:null)};r.refresh=(p={})=>a._asyncDataPromises[e]?a._asyncDataPromises[e]:p._initial&&l()?a.payload.data[e]:(r.pending.value=!0,a._asyncDataPromises[e]=new Promise((i,$)=>{try{i(u(a))}catch(N){$(N)}}).then(i=>{t.transform&&(i=t.transform(i)),t.pick&&(i=se(i,t.pick)),r.data.value=i,r.error.value=null}).catch(i=>{r.error.value=i,r.data.value=g(t.default())}).finally(()=>{r.pending.value=!1,a.payload.data[e]=r.data.value,r.error.value&&(a.payload._errors[e]=!0),delete a._asyncDataPromises[e]}),a._asyncDataPromises[e]);const f=()=>r.refresh({_initial:!0}),c=t.server!==!1&&a.payload.serverRendered;{c&&a.isHydrating&&e in a.payload.data?r.pending.value=!1:o&&a.payload.serverRendered&&(a.isHydrating||t.lazy)?o._nuxtOnBeforeMountCbs.push(f):f(),t.watch&&B(t.watch,()=>r.refresh());const p=a.hook("app:data:refresh",i=>{if(!i||i.includes(e))return r.refresh()});o&&C(p)}const v=Promise.resolve(a._asyncDataPromises[e]).then(()=>r);return Object.assign(v,r),v}function se(s,n){const e={};for(const u of n)e[u]=s[u];return e}function ae(s){return{}}const y=s=>(X("data-v-b860b54e"),s=s(),Y(),s),oe={key:0},re={key:1,class:"flex flex-row justify-center items-center mt-12"},ne=y(()=>d("iframe",{width:"300",height:"300",src:"../assets/animated/logo-paste-loading.svg",alt:"Loading"},null,-1)),ie=y(()=>d("div",{class:"bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},[d("h2",{class:"text-2xl font-bold"},"Creating paste")],-1)),de=[ne,ie],le={key:2,class:"flex flex-row justify-center items-center mt-12"},ce=y(()=>d("iframe",{width:"300",height:"300",src:"../assets/animated/logo-paste-created.svg",alt:"Created"},null,-1)),ue={class:"doneText bg-gradient-to-tr from-green to-orange rounded p-6 h-min"},pe=y(()=>d("h2",{class:"text-2xl font-bold"},"Paste created!",-1)),fe=M(" Check it at: "),he=["href"],ye={key:1,class:"flex flex-col items-center space-y-4"},_e=y(()=>d("h2",{class:"text-xl text-gray-300"},"Enter password to view the paste",-1)),me={class:"flex flex-col md:flex-row space-y-2 md:space-y-0"},we={key:2},ge=y(()=>d("div",{class:"flex flex-col justify-center content-center text-center bg-gradient-to-tr from-green to-orange mb-4 p-4 rounded"},[d("h1",{class:"text-3xl text-white text-shadow-sm"}," No paste here ")],-1)),ve=[ge],be={data(){return{editMode:!1,password:"",pastePostingState:0,createdPaste:void 0}},mounted(){this.checkEditMode(),this.paste&&(document.title="Quickpaste | "+this.paste.title.substring(0,25))},methods:{checkEditMode(){this.userStore.user()!=null&&(!this.paste||this.paste.owner.id==this.userStore.id()&&this.$route.query.edit&&(this.editMode=!0))},async rePaste(s){this.pastePostingState=1;const n={"Content-Type":"application/json"};this.password.length!=0&&(n["Paste-Authorization"]=this.password);const e=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"PUT",headers:n,credentials:"include",body:JSON.stringify(s)});e.ok&&(this.pastePostingState=2,this.createdPaste=(await e.json()).result)},async reloadPaste(){if(this.password.length===0){this.notificationStore.addNotification({type:1,title:"Please enter password to enter",level:1});return}const s=await fetch(`/webapi/paste/${this.$route.params.pasteId}`,{method:"GET",headers:{"Paste-Authorization":this.password},credentials:"include"});if(s.ok)this.paste=await s.json(),this.password.length!=0&&(this.paste.password=this.password),this.checkEditMode(),document.title="Quickpaste | "+this.paste.title.substring(0,25);else{switch(s.status){case 401:this.notificationStore.addNotification({type:1,title:"Incorrect password",level:1});break}this.password="",this.err=s.status}}}},xe=Object.assign(be,{__name:"[pasteId]",async setup(s){let n,e;H(),q();const{data:u,error:t}=([n,e]=D(async()=>E("paste",async o=>{const r=Z().currentRoute.value.params.pasteId,f=ae().cookie,c={};return f.split(";").forEach(w=>{const _=w.split("=");c[_[0].trim()]=_[1]}),await $fetch(`${ee().internalGatewayAddress}/api/paste/${r}`,{headers:{Authorization:"ApiKey "+c.quickpaste_auth},parseResponse:JSON.parse})},{server:!0},"$Ihw3rQE6if")),n=await n,e(),n);u.value,t.value&&console.log(t.value);const{data:a}=([n,e]=D(()=>E("error",()=>t.value?t.value.response.status:200,{server:!0},"$nnNzL6MnHs")),n=await n,e(),n);return(o,l)=>{const r=R,f=K("font-awesome-icon");return g(u)?(h(),m("div",oe,[o.pastePostingState==0?(h(),Q(r,{key:0,onSubmit:o.rePaste,class:U(["m-auto",{"max-w-4xl":!o.editMode}]),paste:g(u),editable:o.editMode,submitText:"Re-Paste !"},null,8,["onSubmit","class","paste","editable"])):o.pastePostingState==1?(h(),m("div",re,de)):(h(),m("div",le,[ce,d("div",ue,[pe,d("h3",null,[fe,d("a",{class:"font-bold",href:`/${o.createdPaste.pasteId}`},[M(V(o.createdPaste.pasteId)+" ",1),G(f,{icon:["fas","fa-arrow-up-right-from-square"]})],8,he)])])]))])):g(a)==401?(h(),m("div",ye,[_e,d("div",me,[J(d("input",{onKeyup:l[0]||(l[0]=F((...c)=>o.reloadPaste&&o.reloadPaste(...c),["enter"])),"onUpdate:modelValue":l[1]||(l[1]=c=>W(password)?password.value=c:null),type:"password",autocomplete:"off",class:"p-2 w-full md:w-auto text-center text-white rounded border-none focus:outline-none text-lg text-bold bg-darkgray mr-4"},null,544),[[L,o.password]]),d("button",{onClick:l[2]||(l[2]=(...c)=>o.reloadPaste&&o.reloadPaste(...c)),class:"bg-gradient-to-tr from-green to-orange rounded p-2 text-center hover:shadow-lg"},"Enter")])])):(h(),m("div",we,ve))}}}),Ce=T(xe,[["__scopeId","data-v-b860b54e"]]);export{Ce as default};
