import{_ as k}from"./UserPanel.4afd7d5e.mjs";import{z as N,j as S,v as d,k as $,o as r,b as l,l as _,e as o,u as m,F as C,r as M,G as g,t as u,c as p,Q as x,R as j,X as D,S as T,N as I}from"./entry.4a081f8d.mjs";const E={class:"flex flex-col md:flex-row w-full justify-between"},O={class:"md:w-4/5"},R=o("h1",{class:"text-5xl mb-6 text-orange text-shadow-sm border-b border-blue pb-4"},"Pastes",-1),B=["href"],L={class:"text-2xl font-bold"},V={class:"text-sm font-normal italic text-gray-500"},F={class:"flex flex-row justify-between"},H=["href"],J=["onClick"],Q={key:1,class:"text-center"},U=o("h2",{class:"text-gray-400"},[g("You can create some pastes "),o("a",{href:"/",class:"text-green"},"here")],-1),z=[U],A={methods:{async loadMorePastes(){const i=this.$refs["paste-container"],c=i.scrollTop+i.clientHeight;if(this.nextPageId&&c>i.scrollHeight-20&&!this.loadingMore){this.loadingMore=!0;const n=await $fetch(`/api/user/pastes?pageId=${this.nextPageId}`,{credentials:"include",parseResponse:JSON.json});this.nextPageId=n.result.nextPage;for(let t=0;t<n.result.pastes.length;t++)n.result.pastes[t].created=new Date(n.result.pastes[t].created).toLocaleDateString();this.pastes=this.pastes.concat(n.result.pastes),this.loadingMore=!1}}},mounted(){this.pastes.length===0&&this.refreshPastes()}},q=Object.assign(A,{__name:"index",setup(i){const c=N(),n=S();let t=d([]),w=d(void 0);d(!1);const b=async e=>{await n.addNotification({type:I.CONFIRM,title:"Delete paste?",description:"This action can not be reversed!"})&&(await $fetch(`/api/paste/${e}`,{method:"DELETE",credentials:"include"}),await y())},y=async()=>{const e=await $fetch("/api/user/pastes",{credentials:"include",parseResponse:JSON.json});t.value=e.result.pastes,w.value=e.result.nextPage;for(let a=0;a<t.value.length;a++)t.value[a].created=new Date(t.value[a].created).toLocaleDateString()},f=e=>{document.title=`Quickpaste | ${e}`};{let e=c.username();e==""?setTimeout(()=>{let a=c.username();f(a)},200):f(e)}return(e,a)=>{const v=k,h=$("font-awesome-icon"),P=T;return r(),l("div",E,[_(v),o("div",O,[R,m(t).length>0?(r(),l("div",{key:0,ref:"paste-container",class:"max-h-prose overflow-y-auto",onScroll:a[0]||(a[0]=(...s)=>e.loadMorePastes&&e.loadMorePastes(...s))},[(r(!0),l(C,null,M(m(t),s=>(r(),l("div",{key:s.uuid,class:"flex flex-col md:flex-row justify-between content-cetner mr-2 p-2 px-8 mb-4 rounded bg-blue"},[o("a",{href:`/${s.uuid}`},[o("h3",L,[g(u(s.title)+" ",1),o("span",V,"#"+u(s.uuid),1),s.isPrivate?(r(),p(h,{key:0,icon:["fas","fa-eye-slash"],class:"text-sm ml-2 mb-px"})):x("",!0),s.password?(r(),p(h,{key:1,icon:["fas","fa-lock"],class:"text-sm ml-2 mb-px"})):x("",!0)]),_(P,null,{default:j(()=>[o("p",null,"Created: "+u(s.created),1)]),_:2},1024)],8,B),o("div",F,[o("a",{class:"bg-green flex-1 m-2 rounded p-4 text-center",href:`/${s.uuid}?edit=1`},"Edit",8,H),o("button",{class:"bg-red-600 flex-1 m-2 rounded p-4 text-center",onClick:D(G=>b(s.uuid),["stop"])},"Remove",8,J)])]))),128))],544)):(r(),l("div",Q,z))])])}}});export{q as default};
